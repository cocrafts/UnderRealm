System.register("chunks:///_virtual/animation.ts",["cc"],(function(n){var t;return{setters:[function(n){t=n.cclegacy}],execute:function(){t._RF.push({},"07fc1gMvsRJn5e5KYLoXi+S","animation",void 0);n("playAnimation",(function(n,t,i){void 0===t&&(t="fade-in");var e=n.getComponent("cc.Animation");i&&(e.getState(t).duration=i);e.play(t)}));t._RF.pop()}}}));

System.register("chunks:///_virtual/attribute.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index.mjs_cjs=&original=.js","./helper.ts","./system.ts","./index.js"],(function(e){var t,n,r,a,i,o,c;return{setters:[function(e){t=e.asyncToGenerator,n=e.regeneratorRuntime},function(e){r=e.cclegacy,a=e.Label},null,function(e){i=e.getPositiveColor},function(e){o=e.system},function(e){c=e.default}],execute:function(){r._RF.push({},"5d676dPc+hFdLWQ6zfYuqKi","attribute",void 0);var l=c.getCard,u=c.getCardState,d=c.getFacingIdentifier,s=c.getEnemyId,h=c.selectPlayer,g=c.selectGround,f=c.getComputedAttribute,p=(e("updateGroundUnits",(function(){o.duel.firstGround.forEach(p),o.duel.secondGround.forEach(p)})),e("updateUnit",function(){var e=t(n().mark((function e(t){var r,c,s,h,g,p,v,y,C,m,P,b,k,B,S,x,w,R,j,G,H,F,N,_,E,I,L,M,U;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=o.cardRefs[t]){e.next=3;break}return e.abrupt("return");case 3:if(h=l(o.duel.cardMap,t),g=h.attribute,p=u(o.duel.stateMap,t),v=f(o.duel,t),y=f(o.predict,t),C=d(o.duel,p.owner,p.id),m=s.getChildByPath("front/health"),P=m.getComponent(a),b=s.getChildByPath("front/defense"),k=b.getComponent(a),B=s.getChildByPath("front/attack"),S=B.getComponent(a),x=s.getChildByPath("front/charge/value").getComponent(a),w=s.getChildByPath("front/death"),R=s.getChildByPath("prediction/health"),j=R.getComponent(a),G=s.getChildByPath("prediction/defense"),H=G.getComponent(a),F=s.getChildByPath("prediction/attack"),N=F.getComponent(a),P.string=String(v.health),P.color=i(v.health,g.health),k.string=String(v.defense),k.color=i(v.defense,g.defense),S.string=String(v.attack),S.color=i(v.attack,g.attack),void 0!==v.charge&&(x.string=String(v.charge)),G.active=!1,G.active=!1,R.active=!1,G.active=!1,F.active=!1,w.active=!1,_=o.cardRefs[null==C?void 0:C.id],E=null==(r=s.getChildByPath("back"))?void 0:r.active,I=null==_||null==(c=_.getChildByPath("back"))?void 0:c.active,_&&!E&&!I){e.next=41;break}return e.abrupt("return");case 41:L=y.health-v.health,M=y.defense-v.defense,U=y.attack-v.attack,y.health<=0&&(w.active=!0),0===L?R.active=!1:(R.active=!0,j.string=String(L),j.color=i(L)),0===M?G.active=!1:(G.active=!0,H.string=String(M),H.color=i(M)),0===U?F.active=!1:(F.active=!0,N.string=String(U),N.color=i(U));case 48:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),v=(e("updatePlayers",function(){var e=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[v(o.duel.firstPlayer.id),v(o.duel.secondPlayer.id)],e.next=3,Promise.all(t);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()),e("updatePlayer",function(){var e=t(n().mark((function e(t){var r,i,c,l,u,d,p,v,y,C,m,P,b,k,B;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=h(o.duel,t),i=s(o.duel,t),c=g(o.duel,t),l=g(o.duel,i),u=r.id===o.playerIds.me,d=u?o.globalNodes.playerHealth:o.globalNodes.enemyHealth,p=u?o.globalNodes.playerHealthPredict:o.globalNodes.enemyHealthPredict,v=d.getComponent(a),y=p.getComponent(a),C=0,m=0;m<l.length;m+=1)b=l[m]&&!c[m],k=o.cardRefs[l[m]],!b||null!=k&&null!=(P=k.getChildByPath("back"))&&P.active||(B=f(o.duel,l[m]),C-=B.attack);v.string=String(r.health),y.string=String(C),p.active=0!==C;case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));r._RF.pop()}}}));

System.register("chunks:///_virtual/BoardManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index.mjs_cjs=&original=.js","./layout.ts","./resources.ts","./system.ts","./index.ts","./index2.ts","./index.js","./sender.ts","./card.ts","./common.ts"],(function(e){var t,n,a,o,d,i,s,l,r,u,h,c,y;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,a=e._decorator,o=e.Label,d=e.Component},null,function(e){i=e.getPositionExpos},function(e){s=e.switchBackgroundSound},function(e){l=e.system},null,null,function(e){r=e.default},function(e){u=e.sendConnect},function(e){h=e.animateGlowOn,c=e.animateGlowOff},function(e){y=e.simpleMove}],execute:function(){var p;n._RF.push({},"5e9daqPUfNBGZ6nn1SQvftq","BoardManager",void 0);var g=r.CardType,b=r.DuelPhases,m=r.DuelPlace,f=r.getCard,P=r.selectHand,C=r.selectPlayer,H=r.selectStateKey,B=r.version,N=a.ccclass,G=(e("BoardManager",N("BoardManager")(p=function(e){function n(){for(var t,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(t=e.call.apply(e,[this].concat(a))||this).unSubscribers=[],t.playerDeckCount=void 0,t.enemyDeckCount=void 0,t.props={},t}t(n,e);var a=n.prototype;return a.start=function(){var e=this.node.getChildByPath("Air/fog"),t=this.node.getChildByPath("Card Template"),n=this.node.getChildByPath("Unit Template"),a=this.node.getChildByPath("Surface/Unit Preview"),d=this.node.getChildByPath("Surface/Player Deck/foil"),i=this.node.getChildByPath("Surface/Enemy Deck/foil"),s=this.node.getChildByPath("Guide/centerExpo"),r=this.node.getChildByPath("Guide/leftExpo"),h=this.node.getChildByPath("Guide/rightExpo"),c=this.node.getChildByPath("playerHand"),y=this.node.getChildByPath("Surface/enemyHand"),p=this.node.getChildByPath("Surface/playerGround"),g=this.node.getChildByPath("Surface/enemyGround"),b=this.node.getChildByPath("Guide/playerHand"),m=this.node.getChildByPath("Guide/playerGround"),f=this.node.getChildByPath("Guide/enemyHand"),P=this.node.getChildByPath("Guide/enemyGround"),C=this.node.getChildByPath("Guide/summonZone"),H=this.node.getChildByPath("Hud/version"),N=this.node.getChildByPath("Hud/playerHealth"),G=this.node.getChildByPath("Hud/playerHealthPredict"),S=this.node.getChildByPath("Hud/enemyHealth"),v=this.node.getChildByPath("Hud/enemyHealthPredict");this.playerDeckCount=this.node.getChildByPath("Surface/playerDeckCount").getComponent(o),this.enemyDeckCount=this.node.getChildByPath("Surface/enemyDeckCount").getComponent(o),H.getComponent(o).string="version "+B,l.globalNodes.board=this.node,l.globalNodes.fog=e,l.globalNodes.cardTemplate=t,l.globalNodes.unitTemplate=n,l.globalNodes.unitPreview=a,l.globalNodes.playerDeck=d,l.globalNodes.enemyDeck=i,l.globalNodes.centerExpo=s,l.globalNodes.leftExpo=r,l.globalNodes.rightExpo=h,l.globalNodes.playerHand=c,l.globalNodes.enemyHand=y,l.globalNodes.playerGround=p,l.globalNodes.enemyGround=g,l.globalNodes.playerHandGuide=b,l.globalNodes.playerGroundGuide=m,l.globalNodes.enemyHandGuide=f,l.globalNodes.enemyGroundGuide=P,l.globalNodes.summonZoneGuide=C,l.globalNodes.playerHealth=N,l.globalNodes.playerHealthPredict=G,l.globalNodes.enemyHealth=S,l.globalNodes.enemyHealthPredict=v,l.globalNodes.board.on("stateReady",this.onStateReady.bind(this)),l.context&&this.onStateReady(),u()},a.onDestroy=function(){this.unSubscribers.forEach((function(e){return e()}))},a.onStateReady=function(){this.unSubscribers.push(l.duel.subscribe(H(l.duel,l.playerIds.me,m.Player),this.onPlayerUpdate.bind(this),!0)),this.unSubscribers.push(l.duel.subscribe(H(l.duel,l.playerIds.me,m.Deck),this.onPlayerDeckUpdate.bind(this),!0)),this.unSubscribers.push(l.duel.subscribe(H(l.duel,l.playerIds.enemy,m.Deck),this.onEnemyDeckUpdate.bind(this),!0)),this.unSubscribers.push(l.duel.subscribe(H(l.duel,l.playerIds.me,m.Hand),this.onPlayerHandUpdate.bind(this))),this.unSubscribers.push(l.duel.subscribe(H(l.duel,l.playerIds.enemy,m.Hand),this.onEnemyHandUpdate.bind(this))),this.unSubscribers.push(l.duel.subscribe("phase",this.onPhaseUpdate.bind(this)))},a.onPlayerUpdate=function(e,t){var n=this;e.perTurnHero!==(null==t?void 0:t.perTurnHero)&&setTimeout((function(){return n.updateInteractions()}),0),(null==t?void 0:t.health)>G&&e.health<G&&s("bgm-dungeon-peak",.2)},a.onPlayerDeckUpdate=function(e){this.playerDeckCount.string=String(e.length)},a.onEnemyDeckUpdate=function(e){this.enemyDeckCount.string=String(e.length)},a.onPlayerHandUpdate=function(e){this.reArrangeHand(l.playerIds.me,e)},a.onEnemyHandUpdate=function(e){this.reArrangeHand(l.playerIds.enemy,e)},a.onPhaseUpdate=function(){var e=this;setTimeout((function(){return e.updateInteractions()}),0)},a.updateInteractions=function(){var e=C(l.duel,l.playerIds.me),t=l.duel.phaseOf===l.playerIds.me,n=l.duel.phase===b.Setup,a=t&&n,o=a&&e.perTurnHero>0,d=P(l.duel,l.playerIds.me);l.isCommandAble=a,d.forEach((function(e){var t=f(l.duel.cardMap,e),n=l.cardRefs[e],a=t.kind===g.Hero,d=t.kind===g.Troop;n&&(d?l.isCommandAble?h(n):c(n):a&&(o?h(n):c(n)))}))},a.reArrangeHand=function(e,t){for(var n=l.playerIds.me===e?i(l.globalNodes.playerHandGuide,t.length,80):i(l.globalNodes.enemyHandGuide,t.length,60),a=0;a<t.length;a+=1){var o=l.cardRefs[t[a]];o&&y(o,n[a])}},n}(d))||p),150);n._RF.pop()}}}));

System.register("chunks:///_virtual/card.ts",["cc","./resources.ts"],(function(e){var t,n,o,a,i,r;return{setters:[function(e){t=e.cclegacy,n=e.Vec3,o=e.Quat,a=e.tween,i=e.UIOpacity},function(e){r=e.playEffectSound}],execute:function(){t._RF.push({},"2f0a9Qfu0pMZbbRkYU6OxCF","card",void 0);var c=new n(440,-15,0),s=new n(425,-232,0),l=e("animateExpoCard",(function(e){var t=e.node,i=e.from,l=void 0===i?s:i,u=e.dest,d=void 0===u?c:u,f=e.delay,p=void 0===f?0:f,w=e.speed,v=void 0===w?1:w,g=!1,m=new n(d.x,d.y-25,d.z),y=o.fromEuler(new o,90,90,91),O=o.fromEuler(new o,12,0,0),x=o.fromEuler(new o,0,0,0),E=a(t).set({position:l}).to(.5/v,{position:m},{easing:"cubicIn"}).to(1.5/v,{position:d},{easing:"backIn"}),b=a(t).set({rotation:y,active:!0}).to(.5/v,{rotation:O},{easing:"cubicIn",onUpdate:function(e){if(!g){var t=new n(0,0,0);e.rotation.getEulerAngles(t),t.z<30&&(r("card-flip",.3),e.getChildByPath("back").active=!1,g=!0)}}}).to(1.5/v,{rotation:x},{easing:"quadIn"}),h=a(t).set({scale:new n(.18,.18,1)}).to(.5/v,{scale:new n(.48,.48,1)},{easing:"quadIn"}).to(1/v,{scale:new n(.5,.5,1)},{easing:"quadOut"});return a(t).delay(p).parallel(E,b,h)})),u=new n(0,-360,0);e("animateDrawPlayerCard",(function(e){var t=e.node,o=e.from,a=void 0===o?s:o,i=e.expoDest,d=void 0===i?c:i,f=e.dest,p=void 0===f?u:f,w=e.delay,v=void 0===w?0:w,g=e.speed,m=void 0===g?1:g;return new Promise((function(e){l({node:t,from:a,dest:d,delay:v,speed:m}).to(.8,{position:p,scale:new n(.4,.4,1)},{easing:"expoOut"}).call((function(){r("light-fire",.3),e()})).start()}))})),e("animateDrawEnemyCard",(function(e){var t=e.node,i=e.from,c=e.dest,s=e.delay,l=void 0===s?0:s;return new Promise((function(e){var s=o.fromEuler(new o,0,0,90),u=o.fromEuler(new o,0,0,180);a(t).delay(l).call((function(){return r("card-flip",.3)})).set({position:i,rotation:s,scale:new n(.18,.18,1)}).to(1,{position:c,rotation:u,scale:new n(.28,.28,1)},{easing:"expoInOut"}).call((function(){return e()})).start()}))})),e("animateGlowOn",(function(e){var t=e.getChildByPath("glow");t.active=!0,a(t.getComponent(i)).set({opacity:0}).to(3,{opacity:150},{easing:"expoOut"}).start()})),e("animateGlowOff",(function(e){var t=e.getChildByPath("glow");a(t.getComponent(i)).to(1,{opacity:0},{easing:"expoOut"}).call((function(){return t.active=!1})).start()})),e("animateGroundReveal",(function(e,t){return void 0===t&&(t=50),new Promise((function(i){var r=!1,c=o.fromEuler(new o,180,0,0),s=o.fromEuler(new o,0,0,0),l=a(e).by(.25,{position:new n(0,t,0)},{easing:"backOut"}).by(.75,{position:new n(0,-t,0)},{easing:"expoOut"}),u=a(e).to(.25,{scale:new n(.25,.25,1)}).to(.75,{scale:new n(.24,.24,1)},{easing:"backOut"}),d=a(e).set({rotation:c}).to(1,{rotation:s},{easing:"expoOut",onUpdate:function(e){if(!r){var t=new n(0,0,0);e.rotation.getEulerAngles(t),t.x<90&&(e.getChildByPath("back").active=!1,r=!0)}}}).call(i).start();a(e).parallel(l,u,d).call(i).start()}))}));t._RF.pop()}}}));

System.register("chunks:///_virtual/Card3D.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,i,r,n,a,o,s,l,u,c,h,d,x;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,r=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){a=e.cclegacy,o=e._decorator,s=e.Camera,l=e.Node,u=e.RenderTexture,c=e.MeshRenderer,h=e.Material,d=e.RichText,x=e.Component}],execute:function(){var T,p,f,m,C,v,g,y,b;a._RF.push({},"ff0eekNoGVKV6rI+QdigqyP","Card3D",void 0);var M=o.ccclass,k=o.property;e("Card3D",(T=M("Card3D"),p=k(s),f=k(l),m=k(l),T((g=t((v=function(e){function t(){for(var t,i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return t=e.call.apply(e,[this].concat(a))||this,r(t,"uiCamera",g,n(t)),r(t,"nameText",y,n(t)),r(t,"skillText",b,n(t)),t.renderTexture=null,t.textMaterial=null,t}i(t,e);var a=t.prototype;return a.onLoad=function(){this.initRenderTexture(),this.setupCardMaterial(),this.updateCardText("name of the card","skill of the card")},a.initRenderTexture=function(){this.renderTexture=new u,this.renderTexture.reset({width:512,height:256})},a.setupCardMaterial=function(){var e=this.node.getComponentInChildren(c);e&&(this.textMaterial=new h,this.textMaterial.initialize({effectName:"builtin-standard"}),this.textMaterial.setProperty("albedoMap",this.renderTexture),e.setMaterialInstance(this.textMaterial,0))},a.updateCardText=function(e,t){var i=this.nameText.getComponent(d),r=this.skillText.getComponent(d);i.string=e,r.string=t,this.renderRichTextToTexture()},a.renderRichTextToTexture=function(){var e=this;this.uiCamera&&this.renderTexture&&(this.uiCamera.node.active=!0,this.uiCamera.targetTexture=this.renderTexture,this.nameText.active=!0,this.nameText.setPosition(0,0,0),this.skillText.active=!0,this.skillText.setPosition(0,0,10),this.uiCamera.node.setPosition(0,0,0),this.scheduleOnce((function(){e.uiCamera.node.active=!1,e.nameText.active=!1,e.skillText.active=!1})))},t}(x)).prototype,"uiCamera",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=t(v.prototype,"nameText",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=t(v.prototype,"skillText",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=v))||C));a._RF.pop()}}}));

System.register("chunks:///_virtual/CardManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index.mjs_cjs=&original=.js","./animation.ts","./helper.ts","./system.ts","./index.js"],(function(t){var i,e,a,n,s,o,r,d,c,l,h,u,g,f,C,v,p,m,b;return{setters:[function(t){i=t.inheritsLoose,e=t.extends},function(t){a=t.cclegacy,n=t._decorator,s=t.Animation,o=t.UIOpacity,r=t.Label,d=t.RichText,c=t.Sprite,l=t.resources,h=t.Component},null,function(t){u=t.playAnimation},function(t){g=t.getSkillDesc,f=t.getVisualUri,C=t.getFoilUri,v=t.getClassUri,p=t.setCursor},function(t){m=t.system},function(t){b=t.default}],execute:function(){var y;a._RF.push({},"cae62yZ7hdE5aT7BjgC31RY","CardManager",void 0);var P=n.ccclass,k=b.getCard;t("CardManager",P("CardManager")(y=function(t){function a(){for(var i,e=arguments.length,a=new Array(e),n=0;n<e;n++)a[n]=arguments[n];return(i=t.call.apply(t,[this].concat(a))||this).unsubscribe=void 0,i.isMouseInside=!1,i.cardId=void 0,i.animation=void 0,i.uiOpacity=void 0,i.cardFront=void 0,i.cardName=void 0,i.cardHealth=void 0,i.cardDefense=void 0,i.cardAttack=void 0,i.cardSkill=void 0,i.cardFoil=void 0,i.cardVisual=void 0,i.cardClass=void 0,i}i(a,t);var n=a.prototype;return n.start=function(){this.cardFront=this.node.getChildByPath("front"),this.animation=this.node.getComponent(s),this.uiOpacity=this.node.getComponent(o),this.cardName=this.node.getChildByPath("front/name").getComponent(r),this.cardAttack=this.node.getChildByPath("front/attack").getComponent(r),this.cardDefense=this.node.getChildByPath("front/defense").getComponent(r),this.cardHealth=this.node.getChildByPath("front/health").getComponent(r),this.cardSkill=this.node.getChildByPath("front/skill").getComponent(d),this.cardFoil=this.node.getChildByPath("front/foil").getComponent(c),this.cardVisual=this.node.getChildByPath("front/visual").getComponent(c),this.cardClass=this.node.getChildByPath("front/class").getComponent(c),this.cardId&&this.subscribeCardChange()},n.onDestroy=function(){var t;null==(t=this.unsubscribe)||t.call(this)},n.setCardId=function(t){var i=this;t!==this.cardId&&(this.cardId=t,t.indexOf("#")>0?this.cardFront&&this.subscribeCardChange():setTimeout((function(){var a=k(m.duel.cardMap,t);i.onStateChange(e({id:t},a.attribute),null)}),200))},n.subscribeCardChange=function(){var t;null==(t=this.unsubscribe)||t.call(this),this.unsubscribe=m.duel.subscribe("state#"+this.cardId,this.onStateChange.bind(this),!0)},n.onStateChange=function(t,i){var e=this,a=k(m.duel.cardMap,t.id),n=t.id.substring(0,9)!==this.cardId.substring(0,9);if(!i){var s=a.title?" - "+a.title:"";this.cardName.string=""+a.name+s,this.cardSkill.string=g(a.skill.template)}if(t.health!==(null==i?void 0:i.health)&&(this.cardHealth.string=String(t.health)),t.defense!==(null==i?void 0:i.defense)&&(this.cardDefense.string=String(t.defense)),t.attack!==(null==i?void 0:i.attack)&&(this.cardAttack.string=String(t.attack)),!i||n){var o=f(a.id),r=C(a.id),d=v(a.class);l.load(o,(function(t,i){t||(e.cardVisual.spriteFrame=i)})),l.load(r,(function(t,i){t||(e.cardFoil.spriteFrame=i)})),l.load(d,(function(t,i){t||(e.cardClass.spriteFrame=i)}))}},n.showPreview=function(){u(m.globalNodes.cardPreview,"fade-in"),m.globalNodes.cardPreview.setPosition(0,-168)},n.hidePreview=function(){m.globalNodes.cardPreview.setPosition(190,740)},n.onMouseEnter=function(){p("grab"),m.dragging||(this.uiOpacity.opacity=50,m.previewing=!0,m.activeCard=this.node,m.globalNodes.cardPreview.setPosition(this.node.position.x,-168),u(m.globalNodes.cardPreview,"fade-in"))},n.onMouseLeave=function(){p("auto"),this.uiOpacity.opacity=255},a}(h))||y);a._RF.pop()}}}));

System.register("chunks:///_virtual/command.ts",["cc","./index.mjs_cjs=&original=.js","./index.js"],(function(e){var o,r;return{setters:[function(e){o=e.cclegacy},null,function(e){r=e.default}],execute:function(){o._RF.push({},"7b3e2BLx9ROUb6NVt3usz5r","command",void 0);var n=r.DuelCommandType,t=r.DuelPlace,l=e("GroundMoves",function(e){return e[e.No=0]="No",e[e.Removal=1]="Removal",e[e.Relocate=2]="Relocate",e[e.GenerateFromAir=3]="GenerateFromAir",e}({})),u=[t.Player,t.Ability];e("extractGroundMove",(function(e){if(e.type!==n.CardMove)return l.No;var o=e.target,r=o.from,a=o.to,c=(null==r?void 0:r.place)===t.Ground,i=(null==a?void 0:a.place)===t.Ground,d=(null==r?void 0:r.place)===t.Deck,m=(null==r||r.place,t.Grave,u.indexOf(r.place)>=0);if(c&&i)return l.Relocate;if(i){if(m)return l.GenerateFromAir;if(!d)return l.GenerateFromAir;console.log("Card from Deck to Ground not supported yet!")}else{if(c)return l.Removal;console.log("Generic move not (between non-ground) supported yet!")}return l.No}));o._RF.pop()}}}));

System.register("chunks:///_virtual/common.ts",["./rollupPluginModLoBabelHelpers.js","cc","./system.ts"],(function(n){var t,e,r,o,a,i,u,c;return{setters:[function(n){t=n.asyncToGenerator,e=n.regeneratorRuntime},function(n){r=n.cclegacy,o=n.tween,a=n.Vec3,i=n.UIOpacity,u=n.Label},function(n){c=n.system}],execute:function(){r._RF.push({},"8872dOQxTdHub5g5T5Ohx4V","common",void 0);n("simpleMove",function(){var n=t(e().mark((function n(t,r,a){return e().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return void 0===a&&(a=.2),n.abrupt("return",new Promise((function(n){o(t).to(a,{position:r},{easing:"expoInOut"}).call((function(){return n()})).start()})));case 2:case"end":return n.stop()}}),n)})));return function(t,e,r){return n.apply(this,arguments)}}()),n("animateFade",function(){var n=t(e().mark((function n(t,r,a){return e().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return void 0===a&&(a=2),n.abrupt("return",new Promise((function(n){o(t.getComponent(i)).to(a,{opacity:r},{easing:"fade"}).call((function(){return n()})).start()})));case 2:case"end":return n.stop()}}),n)})));return function(t,e,r){return n.apply(this,arguments)}}()),n("animateSwapLabel",function(){var n=t(e().mark((function n(t,r,a,c){return e().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return void 0===c&&(c=1),n.abrupt("return",new Promise((function(n){o(t.getComponent(i)).to(c/2,{opacity:0},{easing:"fade",onComplete:function(){var n=t.getComponent(u);n.string=r,n.color=a}}).to(c/2,{opacity:255},{easing:"expoInOut"}).call((function(){return n()})).start()})));case 2:case"end":return n.stop()}}),n)})));return function(t,e,r,o){return n.apply(this,arguments)}}()),n("shakeGround",(function(n,t){void 0===n&&(n=5),void 0===t&&(t=5);for(var e=o(c.globalNodes.board.getChildByPath("Surface")),r=0;r<t;r+=1){var i=Math.random()*n,u=Math.random()*n;e.to(0,{position:new a(i,u,0)}).delay(.08)}e.to(.5,{position:new a(0,0,0)}).start()})),n("animateSkillReady",(function(n){o(n).by(1,{position:new a(0,20,0)},{easing:"expoOut"}).by(1,{position:new a(0,-20,0)},{easing:"expoOut"}).repeatForever().start()}));r._RF.pop()}}}));

System.register("chunks:///_virtual/debug-view-runtime-control.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,o,i,n,s,l,r,a,g,h,p,c,C,d,m,u,L;return{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.inheritsLoose,i=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){s=t.cclegacy,l=t._decorator,r=t.Node,a=t.Color,g=t.Canvas,h=t.UITransform,p=t.instantiate,c=t.Label,C=t.RichText,d=t.Toggle,m=t.Button,u=t.director,L=t.Component}],execute:function(){var f,M,b,v,T,S,x,E,I;s._RF.push({},"b2bd1+njXxJxaFY3ymm06WU","debug-view-runtime-control",void 0);var A=l.ccclass,y=l.property;t("DebugViewRuntimeControl",(f=A("internal.DebugViewRuntimeControl"),M=y(r),b=y(r),v=y(r),f((x=e((S=function(t){function e(){for(var e,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return e=t.call.apply(t,[this].concat(s))||this,i(e,"compositeModeToggle",x,n(e)),i(e,"singleModeToggle",E,n(e)),i(e,"EnableAllCompositeModeButton",I,n(e)),e._single=0,e.strSingle=["No Single Debug","Vertex Color","Vertex Normal","Vertex Tangent","World Position","Vertex Mirror","Face Side","UV0","UV1","UV Lightmap","Project Depth","Linear Depth","Fragment Normal","Fragment Tangent","Fragment Binormal","Base Color","Diffuse Color","Specular Color","Transparency","Metallic","Roughness","Specular Intensity","IOR","Direct Diffuse","Direct Specular","Direct All","Env Diffuse","Env Specular","Env All","Emissive","Light Map","Shadow","AO","Fresnel","Direct Transmit Diffuse","Direct Transmit Specular","Env Transmit Diffuse","Env Transmit Specular","Transmit All","Direct Internal Specular","Env Internal Specular","Internal All","Fog"],e.strComposite=["Direct Diffuse","Direct Specular","Env Diffuse","Env Specular","Emissive","Light Map","Shadow","AO","Normal Map","Fog","Tone Mapping","Gamma Correction","Fresnel","Transmit Diffuse","Transmit Specular","Internal Specular","TT"],e.strMisc=["CSM Layer Coloration","Lighting With Albedo"],e.compositeModeToggleList=[],e.singleModeToggleList=[],e.miscModeToggleList=[],e.textComponentList=[],e.labelComponentList=[],e.textContentList=[],e.hideButtonLabel=void 0,e._currentColorIndex=0,e.strColor=["<color=#ffffff>","<color=#000000>","<color=#ff0000>","<color=#00ff00>","<color=#0000ff>"],e.color=[a.WHITE,a.BLACK,a.RED,a.GREEN,a.BLUE],e}o(e,t);var s=e.prototype;return s.start=function(){if(this.node.parent.getComponent(g)){var t=this.node.parent.getComponent(h),e=.5*t.width,o=.5*t.height,i=.1*e-e,n=o-.1*o,s=this.node.getChildByName("MiscMode"),l=p(s);l.parent=this.node,l.name="Buttons";var r=p(s);r.parent=this.node,r.name="Titles";for(var u=0;u<2;u++){var L=p(this.EnableAllCompositeModeButton.getChildByName("Label"));L.setPosition(i+(u>0?450:150),n,0),L.setScale(.75,.75,.75),L.parent=r;var f=L.getComponent(c);f.string=u?"----------Composite Mode----------":"----------Single Mode----------",f.color=a.WHITE,f.overflow=0,this.labelComponentList[this.labelComponentList.length]=f}n-=20;for(var M=0,b=0;b<this.strSingle.length;b++,M++){b===this.strSingle.length>>1&&(i+=200,M=0);var v=b?p(this.singleModeToggle):this.singleModeToggle;v.setPosition(i,n-20*M,0),v.setScale(.5,.5,.5),v.parent=this.singleModeToggle.parent;var T=v.getComponentInChildren(C);T.string=this.strSingle[b],this.textComponentList[this.textComponentList.length]=T,this.textContentList[this.textContentList.length]=T.string,v.on(d.EventType.TOGGLE,this.toggleSingleMode,this),this.singleModeToggleList[b]=v}i+=200,this.EnableAllCompositeModeButton.setPosition(i+15,n,0),this.EnableAllCompositeModeButton.setScale(.5,.5,.5),this.EnableAllCompositeModeButton.on(m.EventType.CLICK,this.enableAllCompositeMode,this),this.EnableAllCompositeModeButton.parent=l;var S=this.EnableAllCompositeModeButton.getComponentInChildren(c);this.labelComponentList[this.labelComponentList.length]=S;var x=p(this.EnableAllCompositeModeButton);x.setPosition(i+90,n,0),x.setScale(.5,.5,.5),x.on(m.EventType.CLICK,this.changeTextColor,this),x.parent=l,(S=x.getComponentInChildren(c)).string="TextColor",this.labelComponentList[this.labelComponentList.length]=S;var E=p(this.EnableAllCompositeModeButton);E.setPosition(i+200,n,0),E.setScale(.5,.5,.5),E.on(m.EventType.CLICK,this.hideUI,this),E.parent=this.node.parent,(S=E.getComponentInChildren(c)).string="Hide UI",this.labelComponentList[this.labelComponentList.length]=S,this.hideButtonLabel=S,n-=40;for(var I=0;I<this.strMisc.length;I++){var A=p(this.compositeModeToggle);A.setPosition(i,n-20*I,0),A.setScale(.5,.5,.5),A.parent=s;var y=A.getComponentInChildren(C);y.string=this.strMisc[I],this.textComponentList[this.textComponentList.length]=y,this.textContentList[this.textContentList.length]=y.string,A.getComponent(d).isChecked=!!I,A.on(d.EventType.TOGGLE,I?this.toggleLightingWithAlbedo:this.toggleCSMColoration,this),this.miscModeToggleList[I]=A}n-=150;for(var D=0;D<this.strComposite.length;D++){var B=D?p(this.compositeModeToggle):this.compositeModeToggle;B.setPosition(i,n-20*D,0),B.setScale(.5,.5,.5),B.parent=this.compositeModeToggle.parent;var w=B.getComponentInChildren(C);w.string=this.strComposite[D],this.textComponentList[this.textComponentList.length]=w,this.textContentList[this.textContentList.length]=w.string,B.on(d.EventType.TOGGLE,this.toggleCompositeMode,this),this.compositeModeToggleList[D]=B}}else console.error("debug-view-runtime-control should be child of Canvas")},s.isTextMatched=function(t,e){var o=new String(t),i=o.search(">");return-1===i?t===e:(o=(o=o.substr(i+1)).substr(0,o.search("<")))===e},s.toggleSingleMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strSingle.length;i++)this.isTextMatched(o.string,this.strSingle[i])&&(e.singleMode=i)},s.toggleCompositeMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strComposite.length;i++)this.isTextMatched(o.string,this.strComposite[i])&&e.enableCompositeMode(i,t.isChecked)},s.toggleLightingWithAlbedo=function(t){u.root.debugView.lightingWithAlbedo=t.isChecked},s.toggleCSMColoration=function(t){u.root.debugView.csmLayerColoration=t.isChecked},s.enableAllCompositeMode=function(t){var e=u.root.debugView;e.enableAllCompositeMode(!0);for(var o=0;o<this.compositeModeToggleList.length;o++){this.compositeModeToggleList[o].getComponent(d).isChecked=!0}var i=this.miscModeToggleList[0].getComponent(d);i.isChecked=!1,e.csmLayerColoration=!1,(i=this.miscModeToggleList[1].getComponent(d)).isChecked=!0,e.lightingWithAlbedo=!0},s.hideUI=function(t){var e=this.node.getChildByName("Titles"),o=!e.active;this.singleModeToggleList[0].parent.active=o,this.miscModeToggleList[0].parent.active=o,this.compositeModeToggleList[0].parent.active=o,this.EnableAllCompositeModeButton.parent.active=o,e.active=o,this.hideButtonLabel.string=o?"Hide UI":"Show UI"},s.changeTextColor=function(t){this._currentColorIndex++,this._currentColorIndex>=this.strColor.length&&(this._currentColorIndex=0);for(var e=0;e<this.textComponentList.length;e++)this.textComponentList[e].string=this.strColor[this._currentColorIndex]+this.textContentList[e]+"</color>";for(var o=0;o<this.labelComponentList.length;o++)this.labelComponentList[o].color=this.color[this._currentColorIndex]},s.onLoad=function(){},s.update=function(t){},e}(L)).prototype,"compositeModeToggle",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=e(S.prototype,"singleModeToggle",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=e(S.prototype,"EnableAllCompositeModeButton",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=S))||T));s._RF.pop()}}}));

System.register("chunks:///_virtual/draw.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index.mjs_cjs=&original=.js","./CardManager.ts","./index2.ts","./helper.ts","./layout.ts","./system.ts","./index.js","./card.ts"],(function(e){var n,t,a,r,s,o,l,d,i,u,c,p,g;return{setters:[function(e){n=e.asyncToGenerator,t=e.regeneratorRuntime},function(e){a=e.cclegacy,r=e.instantiate},null,function(e){s=e.CardManager},null,function(e){o=e.selectDeckNode},function(e){l=e.getPositionExpos,d=e.getCenterExpos,i=e.getRightExpos},function(e){u=e.system},function(e){c=e.default},function(e){p=e.animateDrawPlayerCard,g=e.animateDrawEnemyCard}],execute:function(){a._RF.push({},"10052xP8+NAn7svrXkPdWcj","draw",void 0);var f=c.selectHand;e("playDraw",function(){var e=n(t().mark((function e(n){var a,c,m,y,h,x,v,w,C,N,P,b,j,H,D;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=n.phaseOf,c=n.commands,m=[],y=f(u.duel,a),h=o(a).parent.getPosition(),x=u.playerIds.me===a,v=x?l(u.globalNodes.playerHandGuide,y.length,80):l(u.globalNodes.enemyHandGuide,y.length,60),w=c.length>3?d:i,C=w(c.length),N=0;N<c.length;N+=1)P=y.length-c.length+N,b=y[P],j=v[P],H=C[N],(D=r(u.globalNodes.cardTemplate)).getComponent(s).setCardId(b),u.cardRefs[b]=D,a===u.playerIds.me?(D.parent=u.globalNodes.playerHand,m.push(p({node:D,from:h,dest:j,expoDest:H,delay:.2*N}))):(D.parent=u.globalNodes.enemyHand,m.push(g({node:D,from:h,dest:j,delay:.2*N})));return e.next=11,Promise.all(m);case 11:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());a._RF.pop()}}}));

System.register("chunks:///_virtual/DuelManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index.mjs_cjs=&original=.js","./helper.ts","./layout.ts","./resources.ts","./system.ts","./CardManager.ts","./index.ts","./index2.ts","./UnitManager.ts","./index.js","./common.ts","./sender.ts","./preview.ts"],(function(e){var i,t,n,o,a,r,d,s,l,u,g,c,v,h,p,C,f,y,P,m,w,b;return{setters:[function(e){i=e.inheritsLoose},function(e){t=e.cclegacy,n=e._decorator,o=e.Node,a=e.AudioSource,r=e.UIOpacity,d=e.Component},null,function(e){s=e.cardIdFromNode,l=e.getMyGround},function(e){u=e.getGroundExpos,g=e.getHandExpos},function(e){c=e.playBackgroundSound,v=e.playEffectSound},function(e){h=e.system},function(e){p=e.CardManager},null,null,function(e){C=e.UnitManager},function(e){f=e.default},function(e){y=e.simpleMove},function(e){P=e.sendCardSummon,m=e.sendCardHover},function(e){w=e.raiseHandCard,b=e.raiseHandPreview}],execute:function(){var M;t._RF.push({},"54ceeKg//pLKpoLmM5uGH72","DuelManager",void 0);var L=n.ccclass,N=o.EventType,x=f.getFirstEmptyLeft,I=f.getFirstEmptyRight,U=f.selectGround,R=f.selectHand;e("DuelManager",L("DuelManager")(M=function(e){function t(){for(var i,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(i=e.call.apply(e,[this].concat(n))||this).previewingLeft=!1,i.previewingRight=!1,i}i(t,e);var n=t.prototype;return n.start=function(){var e;h.audioSource=this.node.getComponent(a),h.globalNodes.duel=this.node,h.globalNodes.cardPreview=this.node.getChildByPath("Card Preview"),h.globalNodes.turnRibbon=this.node.getChildByPath("turnRibbon"),h.globalNodes.duelRibbon=this.node.getChildByPath("duelRibbon"),this.node.on(N.MOUSE_UP,this.onMouseUp.bind(this)),this.node.on(N.MOUSE_MOVE,this.onMouseMove.bind(this)),null==(e=document)||e.getElementById("GameCanvas").addEventListener("mouseout",this.onMouseOut.bind(this)),c("bgm-dungeon-crawl",.3)},n.onUnitPreview=function(){var e=h.globalNodes.unitPreview,i=u(h.globalNodes.playerGroundGuide);if(e.getComponent(C).setCardId(s(h.activeCard)),this.previewingLeft){var t=U(h.duel,h.playerIds.me),n=x(t);e.setPosition(i[n])}else if(this.previewingRight){var o=U(h.duel,h.playerIds.me),a=I(o);e.setPosition(i[a])}else e.setPosition(120,680)},n.onCardDrag=function(e){var i,t=e.getUILocation(),n=t.x,o=t.y,a=h.globalNodes.summonZoneGuide.getWorldPosition();null==(i=h.activeCard)||i.setWorldPosition(n,o,0),o>a.y?n>a.x&&!this.previewingRight?(this.previewingLeft=!1,this.previewingRight=!0,this.onUnitPreview()):n<a.x&&!this.previewingLeft&&(this.previewingLeft=!0,this.previewingRight=!1,this.onUnitPreview()):(this.previewingLeft=!1,this.previewingRight=!1,this.onUnitPreview())},n.onCardDrop=function(e){var i=e.getUILocation(),t=i.x,n=i.y,o=h.globalNodes.summonZoneGuide.getWorldPosition(),a=s(h.activeCard),r=R(h.duel,h.playerIds.me),d=r.indexOf(a),u=g(h.globalNodes.playerHandGuide,r.length);n<o.y?y(h.activeCard,u[d]):t>o.x?P(a,I(l())):P(a,x(l())),h.globalNodes.unitPreview.setPosition(120,680)},n.onMouseUp=function(e){h.dragging&&this.onCardDrop(e),h.dragging=!1,h.activeCard=null},n.onMouseMove=function(e){if(!h.winner&&0!==h.duel.firstMover.length)if(h.dragging&&h.activeCard)this.onCardDrag(e);else if(h.duel&&h.playerIds){var i,t,n=R(h.duel,h.playerIds.me),o=h.globalNodes.playerHandGuide.getWorldPosition(),a=e.getUILocation();if(a.y<o.y+106)for(var r=0;r<n.length;r+=1){var d=n[r],s=h.cardRefs[d];if(s){var l=s.getWorldPosition();if(l.y<o.y+10){var u,g=Math.abs(a.x-l.x);g<((null==(u=i)?void 0:u.distance)||70)&&(i={node:s,cardId:d,distance:g})}}}if(i)i.node.uuid!==(null==(t=h.activeCard)?void 0:t.uuid)&&(h.activeCard&&this.onCardLeave(h.activeCard),this.onCardHover(i.node,i.cardId),h.activeCard=i.node);else h.activeCard&&(this.onCardLeave(h.activeCard),h.activeCard=null)}},n.onMouseOut=function(){var e;h.dragging?null==(e=h.activeCard)||e.setPosition(9999,9999,0):h.activeCard&&(this.onCardLeave(h.activeCard),h.activeCard=null)},n.onCardHover=function(e,i){var t=e.getChildByPath("glow").active,n=h.globalNodes.cardPreview.getChildByPath("Card/glow"),o=h.globalNodes.cardPreview.getChildByPath("Card");n.active=t,o.getComponent(p).setCardId(i.substring(0,9)),h.globalNodes.cardPreview.setPosition(e.position.x,-180),v("hand-slide",.2),w(e,100),b(h.globalNodes.cardPreview),m(i,!0),e.getComponent(r).opacity=20},n.onCardLeave=function(e){h.globalNodes.cardPreview.setPosition(190,740),w(e,0),m(s(e),!1),e.getComponent(r).opacity=255},t}(d))||M);t._RF.pop()}}}));

System.register("chunks:///_virtual/DuelRibbonController.ts",["./rollupPluginModLoBabelHelpers.js","cc","./helper.ts"],(function(o){var t,n,e,i,r,s,u,l;return{setters:[function(o){t=o.inheritsLoose},function(o){n=o.cclegacy,e=o._decorator,i=o.Node,r=o.Button,s=o.sys,u=o.Component},function(o){l=o.setCursor}],execute:function(){var c;n._RF.push({},"4ec72iramJAqoMTYy+w8y4/","DuelRibbonController",void 0);var b=e.ccclass,a=i.EventType,h=r.EventType;o("DuelRibbonController",b("DuelRibbonController")(c=function(o){function n(){for(var t,n=arguments.length,e=new Array(n),i=0;i<n;i++)e[i]=arguments[i];return(t=o.call.apply(o,[this].concat(e))||this).lobbyButton=void 0,t}t(n,o);var e=n.prototype;return e.start=function(){this.lobbyButton=this.node.getChildByPath("Button"),this.lobbyButton.on(a.MOUSE_ENTER,this.onMouseEnter.bind(this)),this.lobbyButton.on(a.MOUSE_LEAVE,this.onMouseLeave.bind(this)),this.lobbyButton.on(h.CLICK,this.onLobbyClick.bind(this))},e.onMouseEnter=function(){l("pointer")},e.onMouseLeave=function(){l("auto")},e.onLobbyClick=function(){s.isBrowser&&(location.href=location.origin+"/game")},n}(u))||c);n._RF.pop()}}}));

System.register("chunks:///_virtual/Example1.ts",["./rollupPluginModLoBabelHelpers.js","cc","./TextMeshPro.ts","./TmpUtils.ts"],(function(t){var e,n,r,i,a,s,o,c,u,l,f,p,h;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,r=t.initializerDefineProperty,i=t.assertThisInitialized,a=t.asyncToGenerator,s=t.regeneratorRuntime},function(t){o=t.cclegacy,c=t._decorator,u=t.Component,l=t.Vec3,f=t.tween},function(t){p=t.default},function(t){h=t.default}],execute:function(){var x,d,g,b,m,v,y,w;o._RF.push({},"0fdd6S55YlEc6iLECOO44mP","Example1",void 0);var _=c.ccclass,V=c.property;t("default",(x=V(p),d=V(p),g=V(p),_((v=e((m=function(t){function e(){for(var e,n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return e=t.call.apply(t,[this].concat(a))||this,r(e,"text1",v,i(e)),r(e,"text2",y,i(e)),r(e,"text3",w,i(e)),e._time=0,e._fScale=1,e._xOffset=0,e._initPos=[],e.alpha=0,e}n(e,t);var o=e.prototype;return o.start=function(){var t=this;this.anim1(),this.anim3(),this.scheduleOnce((function(){for(var e=0;e<t.text2.string.length;e++){var n=t.text2.getPosVertices(e);t._initPos.push(n)}}),0)},o.update=function(t){this._time+=t,this.anim2()},o.anim1=function(){var t=a(s().mark((function t(){var e,n,r,i=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.waitCmpt(this,1);case 2:for(this.text1.string="这 是 一 段 测 试 文 字aaagghjsa;dzxmc;",this.text1.updateRenderData(!0),e=0;e<this.text1.string.length;e++)this.text1.setVisible(e,!1);n=s().mark((function t(e){var n,r,a;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i.text1.setVisible(e,!0),i.text1.isVisible(e)){t.next=3;break}return t.abrupt("return",1);case 3:return n=i.text1.getPosVertices(e),(r=new l).x=(n[0].x+n[1].x+n[2].x+n[3].x)/4,r.y=(n[0].y+n[1].y+n[2].y+n[3].y)/4,i._xOffset=-30,a=function(){var t=[];t.push(n[0].clone()),t.push(n[1].clone()),t.push(n[2].clone()),t.push(n[3].clone());for(var a=0;a<4;a++){var s=new l;l.subtract(s,t[a],r),s.multiplyScalar(i._fScale).add(new l(i._xOffset,0)),l.add(t[a],r,s)}i.text1.setPosVertices(e,t)},f(i).to(.05,{_fScale:2,_xOffset:-15},{onUpdate:a}).to(.05,{_fScale:1,_xOffset:0},{onUpdate:a}).start(),t.next=12,h.waitCmpt(i,.1);case 12:case"end":return t.stop()}}),t)})),r=0;case 7:if(!(r<this.text1.string.length)){t.next=14;break}return t.delegateYield(n(r),"t0",9);case 9:if(!t.t0){t.next=11;break}return t.abrupt("continue",11);case 11:r++,t.next=7;break;case 14:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),o.anim2=function(){if(!(this._initPos.length<=0))for(var t=0;t<this.text2.string.length;t++)if(this.text2.isVisible(t)){for(var e=[],n=0;n<4;n++)e.push(this._initPos[t][n].clone()),e[n].y+=10*Math.sin(.5*t+5*this._time);this.text2.setPosVertices(t,e)}},o.anim3=function(){var t=a(s().mark((function t(){var e,n,r,i=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.waitCmpt(this,1);case 2:for(this.text3.string="这 是 一 段 测 试 文 字aaagghjsa;dzxmc;",this.text3.updateRenderData(!0),e=0;e<this.text3.string.length;e++)this.text3.setVisible(e,!1);.1,n=s().mark((function t(e){var n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i.text3.setVisible(e,!0),i.text3.isVisible(e)){t.next=3;break}return t.abrupt("return",1);case 3:return i.text3.setVisible(e,!1),n=i.text3.getColorExtraVertices(e),i.alpha=0,f(i).to(.05,{alpha:255},{onUpdate:function(){n[0].a=i.alpha,n[2].a=i.alpha,i.text3.setColorExtraVertices(e,n)}}).call((function(){i.alpha=0})).to(.05,{alpha:255},{onUpdate:function(){n[1].a=i.alpha,n[3].a=i.alpha,i.text3.setColorExtraVertices(e,n)}}).start(),t.next=9,h.waitCmpt(i,.1);case 9:case"end":return t.stop()}}),t)})),r=0;case 8:if(!(r<this.text3.string.length)){t.next=15;break}return t.delegateYield(n(r),"t0",10);case 10:if(!t.t0){t.next=12;break}return t.abrupt("continue",12);case 12:r++,t.next=8;break;case 15:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),e}(u)).prototype,"text1",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=e(m.prototype,"text2",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=e(m.prototype,"text3",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=m))||b));o._RF.pop()}}}));

System.register("chunks:///_virtual/fight.ts",["./rollupPluginModLoBabelHelpers.js","cc","./attribute.ts","./resources.ts","./system.ts","./common.ts"],(function(t){var n,e,a,o,r,i,u,s,c,f,l,p,g;return{setters:[function(t){n=t.asyncToGenerator,e=t.regeneratorRuntime},function(t){a=t.cclegacy,o=t.Quat,r=t.tween,i=t.Vec3,u=t.Animation},function(t){s=t.updateUnit,c=t.updatePlayers},function(t){f=t.playEffectSound,l=t.instantiatePrefab},function(t){p=t.system},function(t){g=t.shakeGround}],execute:function(){a._RF.push({},"7c876GrwtFIDb3aU7CgrDTv","fight",void 0);t("animateCardAttack",function(){var t=n(e().mark((function t(n,a,y){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){var e=p.cardRefs[n];if(!e)return t();var d=!1,h=e.getPosition(),m=e.getChildByPath("back"),v=h.y<0?-12:12,w=o.fromEuler(new o,0,180,0),b=o.fromEuler(new o,0,0,0),x=r(e).to(1,{position:new i(h.x,h.y+v,0)},{easing:"backOut"}).to(.2,{position:new i(h.x,0,0)},{easing:"expoOut"}).call((function(){s(n),0===y&&(f("attack",1),g(10,5),c()),l("prefabs/HitEffect").then((function(t){t.parent=e,t.setScale(new i(5,5,1));var n=t.getComponent(u);n.play("flip"),n.on(u.EventType.FINISHED,(function(){t.destroy()}))}))})).to(.5,{position:h},{easing:"expoOut"}),k=null!=m&&m.active?r(e).set({rotation:w}).to(1,{rotation:b},{easing:"expoOut",onUpdate:function(t){if(!d){var n=new i(0,0,0);t.rotation.getEulerAngles(n),n.y<90&&(t.getChildByPath("front").active=!0,m.active=!1,d=!0)}}}):r(e).delay(1);if(a){var P=1280*Math.random()-640;e.parent=p.globalNodes.playerHand,x.to(.5,{position:new i(P,h.y>0?600:-600,0),scale:new i(.6,.6,1)},{easing:"expoIn"}).call((function(){f("death",.5),e.destroy()}))}else x.to(.5,{position:h},{easing:"backOut"});r(e).parallel(x,k).call(t).start()})));case 1:case"end":return t.stop()}}),t)})));return function(n,e,a){return t.apply(this,arguments)}}()),t("animateRelocate",function(){var t=n(e().mark((function t(n,a){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){r(n).to(.2,{position:a},{easing:"expoOut"}).call((function(){f("light-fire",.5),t()})).start()})));case 1:case"end":return t.stop()}}),t)})));return function(n,e){return t.apply(this,arguments)}}());a._RF.pop()}}}));

System.register("chunks:///_virtual/fight2.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index.mjs_cjs=&original=.js","./lodash.mjs_cjs=&original=.js","./index2.ts","./command.ts","./index.js","./lodash.js","./fight.ts"],(function(n){var t,r,e,u,o,i,a,c;return{setters:[function(n){t=n.asyncToGenerator,r=n.regeneratorRuntime},function(n){e=n.cclegacy},null,null,null,function(n){u=n.extractGroundMove,o=n.GroundMoves},function(n){i=n.default},function(n){a=n.default},function(n){c=n.animateCardAttack}],execute:function(){e._RF.push({},"fa55fn2f+RFULVjtFwKBYkV","fight",void 0);var l=i.CommandSourceType,s=(n("playFight",function(){var n=t(r().mark((function n(t){var e,u,o,i;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e=t.commands,u=[],o=e.filter(s),i=e.filter(f).map((function(n){var t;return null==(t=n.target.from)?void 0:t.id})),a.uniqBy(o,(function(n){var t;return null==(t=n.target)||null==(t=t.source)?void 0:t.id})).forEach((function(n,t){var r=n.target.source.id,e=i.findIndex((function(n){return n===r}))>=0;u.push(c(r,e,t))})),n.next=7,Promise.all(u);case 7:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}()),function(n){var t;return(null==(t=n.target)||null==(t=t.source)?void 0:t.type)===l.Unit}),f=function(n){return u(n)===o.Removal};e._RF.pop()}}}));

System.register("chunks:///_virtual/generic.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index.mjs_cjs=&original=.js","./index2.ts","./UnitManager.ts","./command.ts","./helper.ts","./layout.ts","./system.ts","./index.js","./fight.ts","./summon2.ts","./generic2.ts"],(function(e){var t,n,r,a,o,i,s,u,c,l,d,f,m,g,x,p;return{setters:[function(e){t=e.asyncToGenerator,n=e.regeneratorRuntime},function(e){r=e.cclegacy,a=e.instantiate},null,null,function(e){o=e.UnitManager},function(e){i=e.GroundMoves,s=e.extractGroundMove},function(e){u=e.selectGroundGuide,c=e.selectGroundNode},function(e){l=e.getGroundExpos},function(e){d=e.system},function(e){f=e.default},function(e){m=e.animateRelocate},function(e){g=e.animateAirSummon},function(e){x=e.animateGroundRemoval,p=e.animateUnitRaise}],execute:function(){r._RF.push({},"019a6NdF05B0Jm60ofiRgr+","generic",void 0);var k=f.CommandSourceType,b=[k.InspiredSkill,k.PostFightSkill,k.PreFightSkill];e("playGeneric",function(){var e=t(n().mark((function e(t){var r,f,k,G,y,R,v,h,F,S,j,w,M,N,_,C;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.commands,f=0;case 2:if(!(f<r.length)){e.next=41;break}if(G=r[f],y=b.indexOf(null==(k=G.target)||null==(k=k.source)?void 0:k.type)>=0,R=s(G),!y){e.next=11;break}if(!(v=d.cardRefs[G.target.source.id])){e.next=11;break}return e.next=11,p(v);case 11:if(R!==i.Removal){e.next=18;break}if(!(h=d.cardRefs[G.target.from.id])){e.next=16;break}return e.next=16,x(h);case 16:e.next=38;break;case 18:if(R!==i.GenerateFromAir){e.next=29;break}return F=G.target.from.id,S=a(d.globalNodes.unitTemplate),j=l(u(G.target.to.owner)),S.getComponent(o).setCardId(F),S.parent=c(G.target.to.owner),d.cardRefs[F]=S,e.next=27,g(S,j[G.target.to.index]);case 27:e.next=38;break;case 29:if(R!==i.Relocate){e.next=38;break}if(!(w=d.cardRefs[G.target.from.id])){e.next=38;break}return M=G.target.to.owner,N=M===d.playerIds.me,_=N?d.globalNodes.playerGroundGuide:d.globalNodes.enemyGroundGuide,C=l(_),e.next=38,m(w,C[G.target.to.index]);case 38:f+=1,e.next=2;break;case 41:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());r._RF.pop()}}}));

System.register("chunks:///_virtual/generic2.ts",["cc","./resources.ts","./system.ts"],(function(e){var n,t,o,i,s;return{setters:[function(e){n=e.cclegacy,t=e.tween,o=e.Vec3},function(e){i=e.playEffectSound},function(e){s=e.system}],execute:function(){n._RF.push({},"ccb58ZHxqRIY6gXkhzFPcrs","generic",void 0);e("animateGroundRemoval",(function(e){return new Promise((function(n){var a=e.getPosition(),c=1280*Math.random()-640;e.parent=s.globalNodes.playerHand,t(e).to(.5,{position:new o(c,a.y>0?600:-600,0),scale:new o(.6,.6,1)},{easing:"expoIn"}).call((function(){i("death",.5),e.destroy(),n()})).start()}))})),e("animateUnitRaise",(function(e){return new Promise((function(n){var i=e.getPosition().y>0?-20:20;t(e).by(.25,{position:new o(0,i,0)},{easing:"expoOut"}).delay(.5).call(n).by(.25,{position:new o(0,-i,0)},{easing:"expoOut"}).start()}))}));n._RF.pop()}}}));

System.register("chunks:///_virtual/handlers.ts",["cc","./index.mjs_cjs=&original=.js","./index3.ts","./index2.ts","./helper.ts","./system.ts","./util.ts","./index.js","./hud.ts","./preview.ts"],(function(e){var n,t,i,r,s,a,u,c;return{setters:[function(e){n=e.cclegacy},null,function(e){t=e.replay},null,function(e){i=e.extractPlayerIds},function(e){r=e.system},function(e){s=e.mergeRemoteHistory},function(e){a=e.default},function(e){u=e.showEndGameRibbon},function(e){c=e.raiseHandCard}],execute:function(){n._RF.push({},"2337fLW1BhC44IP3JAljEJn","handlers",void 0);var o=a.selectHand,l=a.getInitialState,d=a.mergeFragmentToState;e("connect",(function(e,n){var a,u=e.match;if(!r.winner&&n){var c=u.config,o=u.commandBundles,f=l(c);d(r.duel,f),r.playerIds=i(c,r.userId),null==(a=r.globalNodes.board)||a.emit("stateReady"),s(o,0),setTimeout((function(){return t()}),200)}})),e("incomingBundles",(function(e){var n=e.level,i=e.bundles;r.winner||(s(i,n),t())})),e("gameOver",(function(e){var n=e.winner;if(!r.winner){var t=r.playerIds.me===n;r.winner=n,u(t)}})),e("cardHover",(function(e){for(var n=e.index,t=e.isMouseIn,i=o(r.duel,r.playerIds.enemy),s=0;s<i.length;s+=1){var a=r.cardRefs[i[s]];if(a)c(a,s===n&&t?60:0,.1,"back")}}));n._RF.pop()}}}));

System.register("chunks:///_virtual/helper.ts",["cc","./index.mjs_cjs=&original=.js","./CardManager.ts","./system.ts","./index.js"],(function(e){var r,n,t,a,s,i,o;return{setters:[function(e){r=e.cclegacy,n=e.Vec2,t=e.Vec3,a=e.Color},null,function(e){s=e.CardManager},function(e){i=e.system},function(e){o=e.default}],execute:function(){r._RF.push({},"00337JfbyND4LuNGVh1dtqy","helper",void 0);var c=o.ElementalType,l=o.ClassType,u=o.selectHand,d=o.selectGround,m=(e("extractPlayerIds",(function(e,r){return r===e.firstPlayer.id?{me:e.firstPlayer.id,enemy:e.secondPlayer.id}:{me:e.secondPlayer.id,enemy:e.firstPlayer.id}})),e("cardIdFromNode",(function(e){var r;return null==(r=e.getComponent(s))?void 0:r.cardId})),e("delay",(function(e){return void 0===e&&(e=0),new Promise((function(r){setTimeout((function(){r()}),e)}))})),e("getVisualUri",(function(e){return"graphic/visuals/"+e.substring(0,5)+"/spriteFrame"})),e("getFoilUri",(function(e,r){switch(void 0===r&&(r=""),e.substring(7,9)){case c.Metal:return"graphic/cards/foil-metal"+r+"/spriteFrame";case c.Wood:return"graphic/cards/foil-wood"+r+"/spriteFrame";case c.Water:return"graphic/cards/foil-water"+r+"/spriteFrame";case c.Fire:return"graphic/cards/foil-fire"+r+"/spriteFrame";case c.Earth:return"graphic/cards/foil-earth"+r+"/spriteFrame";case c.Dark:return"graphic/cards/foil-dark"+r+"/spriteFrame";case c.Light:return"graphic/cards/foil-light"+r+"/spriteFrame";default:return"graphic/cards/foil-metal"+r+"/spriteFrame"}})),e("getClassUri",(function(e){switch(e){case l.Knight:return"graphic/cards/class-tank/spriteFrame";case l.Wizard:return"graphic/cards/class-wizard/spriteFrame";case l.Assassin:return"graphic/cards/class-assassin/spriteFrame";case l.Summoner:return"graphic/cards/class-summoner/spriteFrame";default:return"graphic/cards/class-tank/spriteFrame"}})),{black:"#000000",green:"#066922",blue:"#1055BC",red:"#AA1D21",magenta:"#6e13a4"}),g=(e("getSkillDesc",(function(e){return"<color=#222222>"+e.map((function(e){return e.style?"<color="+(m[e.style.color]||"#111111")+">"+e.text+"</color>":e.text})).join("")+"</color>"})),e("setCursor",(function(e){var r,n=null==(r=document)||null==r.getElementById?void 0:r.getElementById("GameCanvas");n&&(n.style.cursor=e)})),e("designScreenSize",new n(1280,720))),f=(e("extractMouseLocation",(function(e){var r=e.x,n=e.y;return new t(r-g.x/2,n-g.y/2,0)})),e("getGroundSize",(function(){var e;return null==(e=i.duel.setting)?void 0:e.groundSize})),e("selectDeckNode",(function(e){return i.playerIds.me===e?i.globalNodes.playerDeck:i.globalNodes.enemyDeck})),e("selectGroundNode",(function(e){return i.playerIds.me===e?i.globalNodes.playerGround:i.globalNodes.enemyGround})),e("selectGroundGuide",(function(e){return i.playerIds.me===e?i.globalNodes.playerGroundGuide:i.globalNodes.enemyGroundGuide})),e("selectHandNode",(function(e){return i.playerIds.me===e?i.globalNodes.playerHand:i.globalNodes.enemyHand})),e("selectHandGuide",(function(e){return i.playerIds.me===e?i.globalNodes.playerHandGuide:i.globalNodes.enemyHandGuide})),e("getHandSize",(function(e){var r;return null==(r=u(i.duel,e))?void 0:r.length}))),p=(e("getMyHandSize",(function(){return f(i.playerIds.me)})),e("getMyGround",(function(){return d(i.duel,i.playerIds.me)})),a.fromHEX(new a,"#1aab1a")),y=a.fromHEX(new a,"#FF0000");e("getPositiveColor",(function(e,r){return void 0===r&&(r=0),e>r?p:e<r?y:a.fromHEX(new a,"#FFFFFF")})),e("getInjectedCardId",(function(e,r){return r.indexOf("#")>=0?r:r+"#"+e.uniqueCardCount}));r._RF.pop()}}}));

System.register("chunks:///_virtual/HtmlParser.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var s,t;return{setters:[function(e){s=e.createForOfIteratorHelperLoose},function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"2e021iqtGxCJ479Ig98rVuT","HtmlParser",void 0);var r=/^(click)(\s)*=|(param)(\s)*=/,i=/(\s)*src(\s)*=|(\s)*height(\s)*=|(\s)*width(\s)*=|(\s)*align(\s)*=|(\s)*offset(\s)*=|(\s)*click(\s)*=|(\s)*param(\s)*=/;e("HtmlTextParser",function(){function e(){this._specialSymbolArray=[],this._stack=[],this._resultObjectArray=[],this._specialSymbolArray.push([/&lt;/g,"<"]),this._specialSymbolArray.push([/&gt;/g,">"]),this._specialSymbolArray.push([/&amp;/g,"&"]),this._specialSymbolArray.push([/&quot;/g,'"']),this._specialSymbolArray.push([/&apos;/g,"'"]),this._specialSymbolArray.push([/&nbsp;/g," "])}var t=e.prototype;return t.parse=function(e){this._resultObjectArray.length=0,this._stack.length=0;for(var s=0,t=e.length;s<t;){var r=e.indexOf(">",s),i=-1;if(r>=0)(i=e.lastIndexOf("<",r))<s-1&&(i=e.indexOf("<",r+1),r=e.indexOf(">",i+1));if(i<0)this._stack.pop(),this._processResult(e.substring(s)),s=t;else{var n=e.substring(s,i),a=e.substring(i+1,r);""===a&&(n=e.substring(s,r+1)),this._processResult(n),-1===r?r=i:"/"===e.charAt(i+1)?this._stack.pop():this._addToStack(a),s=r+1}}return this._resultObjectArray},t._attributeToObject=function(e){e=e.trim();var s={},t=/^(color|size)(\s)*=/.exec(e),r="",n=0,a="";if(t){if(r=t[0],""===(e=e.substring(r.length).trim()))return s;switch(n=e.indexOf(" "),r[0]){case"c":s.color=n>-1?e.substring(0,n).trim():e;break;case"s":s.size=parseInt(e)}return n>-1&&(a=e.substring(n+1).trim(),s.event=this._processEventHandler(a)),s}if((t=/^(br(\s)*\/)/.exec(e))&&t[0].length>0&&(r=t[0].trim()).startsWith("br")&&"/"===r[r.length-1])return s.isNewLine=!0,this._resultObjectArray.push({text:"",style:{isNewLine:!0}}),s;var c="",l=-1;if((t=/^(img(\s)*src(\s)*=[^>]+\/)/.exec(e))&&t[0].length>0&&(r=t[0].trim()).startsWith("img")&&"/"===r[r.length-1]){var o;t=i.exec(e);for(var f=!1;t;){var u=(r=(e=e.substring(e.indexOf(t[0]))).substr(0,t[0].length)).length;if(r=(r=r.replace(/[^a-zA-Z]/g,"").trim()).toLowerCase(),c=e.substring(u).trim(),l="src"===r?this.getRightQuotationIndex(c):-1,o=(n=c.indexOf(" ",l+1>=c.length?-1:l+1))>-1?c.substr(0,n):c,e=c.substring(n).trim(),o.endsWith("/")&&(o=o.slice(0,-1)),"src"===r){switch(o.charCodeAt(0)){case 34:case 39:f=!0,o=o.slice(1,-1)}s.isImage=!0,s.src=o}else if("height"===r)s.imageHeight=parseInt(o);else if("width"===r)s.imageWidth=parseInt(o);else if("align"===r){switch(o.charCodeAt(0)){case 34:case 39:o=o.slice(1,-1)}s.imageAlign=o.toLowerCase()}else"offset"===r?s.imageOffset=o:"click"===r&&(s.event=this._processEventHandler(r+"="+o));s.event&&"param"===r&&(s.event[r]=o.replace(/^"|"$/g,"")),t=i.exec(e)}return f&&s.isImage&&this._resultObjectArray.push({text:"",style:s}),{}}if(t=/^(cg(\s)*[^>]*)/.exec(e)){var g={lb:"#ffffff",rb:"#ffffff",lt:"#ffffff",rt:"#ffffff"};if(e=t[0].substring("cg".length).trim()){var h,b,m=/(\s)*lb(\s)*=|(\s)*rb(\s)*=|(\s)*lt(\s)*=|(\s)*rt(\s)*=/;for(t=m.exec(e);t;)r=(e=e.substring(e.indexOf(t[0]))).substr(0,t[0].length),h=(n=(b=e.substring(r.length).trim()).indexOf(" "))>-1?b.substr(0,n):b,r=(r=r.replace(/[^a-zA-Z]/g,"").trim()).toLocaleLowerCase(),e=b.substring(n).trim(),"lb"===r?g.lb=h:"rb"===r?g.rb=h:"lt"===r?g.lt=h:"rt"===r&&(g.rt=h),t=m.exec(e)}s.colorGradient=g}if(t=/^(face(\s)*[^>]*)/.exec(e)){var p={color:"#ffffff",dilate:.5,softness:.01};if(e=t[0].substring("face".length).trim()){var d,x,v=/(\s)*color(\s)*=|(\s)*dilate(\s)*=|(\s)*softness(\s)*=|(\s)*click(\s)*=|(\s)*param(\s)*=/;for(t=v.exec(e);t;)r=(e=e.substring(e.indexOf(t[0]))).substr(0,t[0].length),d=(n=(x=e.substring(r.length).trim()).indexOf(" "))>-1?x.substr(0,n):x,r=(r=r.replace(/[^a-zA-Z]/g,"").trim()).toLocaleLowerCase(),e=x.substring(n).trim(),"click"===r?s.event=this._processEventHandler(r+"="+d):"color"===r?p.color=d:"dilate"===r?p.dilate=Number(d):"softness"===r&&(p.softness=Number(d)),s.event&&"param"===r&&(s.event.param=d.replace(/^\"|\"$/g,"")),t=v.exec(e)}s.face=p}if(t=/^(outline(\s)*[^>]*)/.exec(e)){var _={color:"#ffffff",thickness:.1};if(e=t[0].substring("outline".length).trim()){var y,k=/(\s)*color(\s)*=|(\s)*thickness(\s)*=|(\s)*click(\s)*=|(\s)*param(\s)*=/;for(t=k.exec(e);t;)r=(e=e.substring(e.indexOf(t[0]))).substr(0,t[0].length),y=(n=(c=e.substring(r.length).trim()).indexOf(" "))>-1?c.substr(0,n):c,r=(r=r.replace(/[^a-zA-Z]/g,"").trim()).toLowerCase(),e=c.substring(n).trim(),"click"===r?s.event=this._processEventHandler(r+"="+y):"color"===r?_.color=y:"thickness"===r&&(_.thickness=Number(y)),s.event&&"param"===r&&(s.event[r]=y.replace(/^"|"$/g,"")),t=k.exec(e)}s.outline=_}if(t=/^(underlay(\s)*[^>]*)/.exec(e)){var O={color:"#ffffff",x:0,y:0,dilate:.5,softness:.1};if(e=t[0].substring("underlay".length).trim()){var A,w,L=/(\s)*color(\s)*=|(\s)*x(\s)*=|(\s)*y(\s)*=|(\s)*dilate(\s)*=|(\s)*softness(\s)*=|(\s)*click(\s)*=|(\s)*param(\s)*=/;for(t=L.exec(e);t;)r=(e=e.substring(e.indexOf(t[0]))).substr(0,t[0].length),A=(n=(w=e.substring(r.length).trim()).indexOf(" "))>-1?w.substr(0,n):w,r=(r=r.replace(/[^a-zA-Z]/g,"").trim()).toLocaleLowerCase(),e=w.substring(n).trim(),"click"===r?s.event=this._processEventHandler(r+"="+A):"color"===r?O.color=A:"dilate"===r?O.dilate=Number(A):"softness"===r?O.softness=Number(A):"x"===r?O.x=Number(A):"y"===r&&(O.y=Number(A)),s.event&&"param"===r&&(s.event.param=A.replace(/^\"|\"$/g,"")),t=L.exec(e)}s.underlay=O}if(t=/^(glow(\s)*[^>]*)/.exec(e)){var N={color:"#000000",offset:.5,inner:.01,outer:.01,power:1};if(e=t[0].substring("glow".length).trim()){var S,H,I=/(\s)*color(\s)*=|(\s)*offset(\s)*=|(\s)*inner(\s)*=|(\s)*outer(\s)*=|(\s)*power(\s)*=|(\s)*click(\s)*=|(\s)*param(\s)*=/;for(t=I.exec(e);t;)r=(e=e.substring(e.indexOf(t[0]))).substr(0,t[0].length),S=(n=(H=e.substring(r.length).trim()).indexOf(" "))>-1?H.substr(0,n):H,r=(r=r.replace(/[^a-zA-Z]/g,"").trim()).toLocaleLowerCase(),e=H.substring(n).trim(),"click"===r?s.event=this._processEventHandler(r+"="+S):"color"===r?N.color=S:"offset"===r?N.offset=Number(S):"inner"===r?N.inner=Number(S):"outer"===r?N.outer=Number(S):"power"===r&&(N.power=Number(S)),s.event&&"param"===r&&(s.event.param=S.replace(/^\"|\"$/g,"")),t=I.exec(e)}s.glow=N}if((t=/^(on|u|s|b|i)(\s)*/.exec(e))&&t[0].length>0){switch(r=t[0],e=e.substring(r.length).trim(),r[0]){case"u":s.underline=!0,s.offset="="===e[0]?Number(e.slice(1)):0;break;case"s":s.strikethrough=!0,s.offset="="===e[0]?Number(e.slice(1)):0;break;case"i":s.italic=!0;break;case"b":s.bold=!0}if(""===e)return s;s.event=this._processEventHandler(e)}return s},t.getRightQuotationIndex=function(e){var s=-1,t=-1,r=e.indexOf("'"),i=e.indexOf('"'),n=i>-1&&(i<r||-1===r);return r>-1&&(r<i||-1===i)?(s=r,t=e.indexOf("'",s+1>=e.length?-1:s+1)):n&&(s=i,t=e.indexOf('"',s+1>=e.length?-1:s+1)),t},t._processEventHandler=function(e){for(var s={},t=0,i=!1,n=r.exec(e);n;){var a=n[0],c="";if(i=!1,'"'===(e=e.substring(a.length).trim()).charAt(0))(t=e.indexOf('"',1))>-1&&(c=e.substring(1,t).trim(),i=!0),t++;else if("'"===e.charAt(0))(t=e.indexOf("'",1))>-1&&(c=e.substring(1,t).trim(),i=!0),t++;else{var l=/(\S)+/.exec(e);t=(c=l?l[0]:"").length}i&&(s[a=a.substring(0,a.length-1).trim()]=c),e=e.substring(t).trim(),n=r.exec(e)}return s},t._addToStack=function(e){var s=this._attributeToObject(e);if(0===this._stack.length)this._stack.push(s);else{if(s.isNewLine||s.isImage)return;var t=this._stack[this._stack.length-1];for(var r in t)s[r]||(s[r]=t[r]);this._stack.push(s)}},t._processResult=function(e){0!==e.length&&(e=this._escapeSpecialSymbol(e),this._stack.length>0?this._resultObjectArray.push({text:e,style:this._stack[this._stack.length-1]}):this._resultObjectArray.push({text:e}))},t._escapeSpecialSymbol=function(e){for(var t,r=s(this._specialSymbolArray);!(t=r()).done;){var i=t.value,n=i[0],a=i[1];e=e.replace(n,a)}return e},e}());t._RF.pop()}}}));

System.register("chunks:///_virtual/hud.ts",["./rollupPluginModLoBabelHelpers.js","cc","./resources.ts","./system.ts"],(function(t){var e,n,o,r,a,c,s,i,u,l,p;return{setters:[function(t){e=t.asyncToGenerator,n=t.regeneratorRuntime},function(t){o=t.cclegacy,r=t.UIOpacity,a=t.Label,c=t.tween,s=t.Vec3,i=t.Sprite},function(t){u=t.playEffectSound,l=t.playBackgroundSound},function(t){p=t.system}],execute:function(){o._RF.push({},"6659dvpcrhIXZgQcMTw+cdQ","hud",void 0);t("showTurnRibbon",function(){var t=e(n().mark((function t(e){var o,i;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=p.globalNodes.turnRibbon,i=o.getComponent(r),o.getChildByPath("message").getComponent(a).string=e,t.abrupt("return",new Promise((function(t){c(o).set({scale:new s(0,0,1),position:new s(0,25,0)}).call((function(){return u("your-turn4",.2)})).to(.5,{scale:new s(1,1,1)},{easing:"backOut"}).delay(1).call((function(){return u("your-turn3",.2)})).call((function(){c(i).to(.25,{opacity:0}).call((function(){o.setPosition(new s(9999,0,0)),i.opacity=255,t()})).start()})).to(.25,{scale:new s(0,0,1)},{easing:"backIn"}).start()})));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t("showEndGameRibbon",function(){var t=e(n().mark((function t(e){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){var n=p.globalNodes.duelRibbon,o=e?"victory":"defeat";n.getChildByPath("ribbon").getComponent(i).grayscale=!e,n.getChildByPath("avatar/image").getComponent(i).grayscale=!e,n.getChildByPath("message").getComponent(a).string=e?"Victory!":"Defeat!",p.globalNodes.playerHand.parent=p.globalNodes.board.getChildByPath("Surface"),c(p.globalNodes.fog.getComponent(r)).to(2,{opacity:255}).start(),c(n).set({scale:new s(0,0,1),position:new s(0,-54,0)}).call((function(){l(o,.5,!1)})).to(.5,{scale:new s(1,1,1)},{easing:"backOut"}).call(t).start()})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());o._RF.pop()}}}));

System.register("chunks:///_virtual/index.ts",["cc","./system.ts","./types.ts","./handlers.ts","./util.ts","./sender.ts"],(function(e){var n,o,t,s,r,d,c,a;return{setters:[function(e){n=e.cclegacy},function(e){o=e.system},function(e){t=e.GameEventType},function(e){s=e.connect,r=e.incomingBundles,d=e.cardHover,c=e.gameOver},function(e){a=e.ws},function(n){var o={};o.internalSendCardHover=n.internalSendCardHover,o.send=n.send,o.sendBundles=n.sendBundles,o.sendCardHover=n.sendCardHover,o.sendCardSummon=n.sendCardSummon,o.sendConnect=n.sendConnect,o.sendEndTurn=n.sendEndTurn,e(o)}],execute:function(){n._RF.push({},"55f29Z1u1NOKo4u5GAKx9s4","index",void 0),a.onmessage=function(e){var n=JSON.parse(e.data),a=n.userId,u=n.type,i=n.payload,l=o.userId===a;u===t.ConnectMatch?s(i,l):u===t.SendBundle?r(i):u===t.CardHover?l||d(i):u===t.GameOver&&c(i)},a.onerror=function(e){console.log(e)},a.onopen=function(){console.log("Websocket opened"),o.isSocketReady=!0},a.onclose=function(){console.log("Websocket closed")};e("waitForSocket",(function(e){void 0===e&&(e=150);var n=0;return new Promise((function(t,s){var r=setInterval((function(){o.isSocketReady?(t(!0),clearInterval(r)):n>e&&(s("too many retries, socket may not be ready"),clearInterval(r)),n+=1}),200)}))}));n._RF.pop()}}}));

System.register("chunks:///_virtual/index2.ts",["cc","./card.ts","./common.ts","./fight.ts","./generic2.ts","./hud.ts","./preview.ts","./summon2.ts"],(function(a){var e;return{setters:[function(a){e=a.cclegacy},function(e){var n={};n.animateDrawEnemyCard=e.animateDrawEnemyCard,n.animateDrawPlayerCard=e.animateDrawPlayerCard,n.animateExpoCard=e.animateExpoCard,n.animateGlowOff=e.animateGlowOff,n.animateGlowOn=e.animateGlowOn,n.animateGroundReveal=e.animateGroundReveal,a(n)},function(e){var n={};n.animateFade=e.animateFade,n.animateSkillReady=e.animateSkillReady,n.animateSwapLabel=e.animateSwapLabel,n.shakeGround=e.shakeGround,n.simpleMove=e.simpleMove,a(n)},function(e){var n={};n.animateCardAttack=e.animateCardAttack,n.animateRelocate=e.animateRelocate,a(n)},function(e){var n={};n.animateGroundRemoval=e.animateGroundRemoval,n.animateUnitRaise=e.animateUnitRaise,a(n)},function(e){var n={};n.showEndGameRibbon=e.showEndGameRibbon,n.showTurnRibbon=e.showTurnRibbon,a(n)},function(e){var n={};n.raiseHandCard=e.raiseHandCard,n.raiseHandPreview=e.raiseHandPreview,n.raiseUnitPreview=e.raiseUnitPreview,a(n)},function(e){var n={};n.animateAirSummon=e.animateAirSummon,n.animateEnemySummon=e.animateEnemySummon,n.animateGroundAppear=e.animateGroundAppear,n.animatePlayerSummon=e.animatePlayerSummon,a(n)}],execute:function(){e._RF.push({},"e4102wyJT5Gkb2YFGpWKVbm","index",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/index3.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index.mjs_cjs=&original=.js","./lodash.mjs_cjs=&original=.js","./index2.ts","./attribute.ts","./system.ts","./draw.ts","./fight2.ts","./generic.ts","./reinforce.ts","./summon.ts","./index.js","./lodash.js","./hud.ts"],(function(e){var n,t,r,a,u,i,s,o,c,l,f,d,m,x;return{setters:[function(e){n=e.asyncToGenerator,t=e.regeneratorRuntime},function(e){r=e.cclegacy},null,null,null,function(e){a=e.updatePlayers,u=e.updateGroundUnits},function(e){i=e.system},function(e){s=e.playDraw},function(e){o=e.playFight},function(e){c=e.playGeneric},function(e){l=e.playReinforce},function(e){f=e.playSummon},function(e){d=e.default},function(e){m=e.default},function(e){x=e.showTurnRibbon}],execute:function(){r._RF.push({},"6e530j/4xlJFa4molbmb3Pe","index",void 0);var p=!1,b=d.BundleGroup,h=d.mergeFragmentToState,y=d.runCommand,g=d.move,k=e("replay",function(){var e=n(t().mark((function e(){var n,r,d,m,h,y,g,j,w;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.history.length,r=i.historyLevel>=n,!(i.winner||p||r)){e.next=4;break}return e.abrupt("return");case 4:p=!0,d=i.historyLevel;case 6:if(!(d<n)){e.next=45;break}if(m=i.history[d],h=null==m?void 0:m.group,y=h===b.InitialDraw,g=h===b.TurnDraw,j=y||g,w=m.phaseOf===i.playerIds.me,v(m),i.winner||!g||!w){e.next=17;break}return e.next=17,x("Your Turn");case 17:if(!j){e.next=22;break}return e.next=20,s(m);case 20:e.next=39;break;case 22:if(b.Summon!==h){e.next=27;break}return e.next=25,f(m);case 25:e.next=39;break;case 27:if(b.FightCombat!==h){e.next=32;break}return e.next=30,o(m);case 30:e.next=39;break;case 32:if(b.Reinforce!==h){e.next=37;break}return e.next=35,l(m);case 35:e.next=39;break;case 37:return e.next=39,c(m);case 39:a(),u(),i.historyLevel+=1;case 42:d+=1,e.next=6;break;case 45:return p=!1,e.next=48,k();case 48:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()),v=e("runCommandBundle",(function(e){e.commands.forEach((function(e){h(i.duel,y({duel:i.duel,command:e}))})),i.predict=g.fight(m.cloneDeep(i.duel)).duel}));r._RF.pop()}}}));

System.register("chunks:///_virtual/layout.ts",["cc","./helper.ts","./system.ts"],(function(t){var e,o,n,r;return{setters:[function(t){e=t.cclegacy,o=t.Vec3},function(t){n=t.getGroundSize},function(t){r=t.system}],execute:function(){e._RF.push({},"82986irFHtFQolYndO2sDqd","layout",void 0);var u=t("getPositionExpos",(function(t,e,n,u){void 0===t&&(t=r.globalNodes.centerExpo),void 0===n&&(n=220);for(var s=[],c=t.getPosition(),g=n*e/2,f=n/2,l=i(e,n,u),p=0;p<e;p+=1){var a=p*n-g+f;s.push(new o(c.x+a+l,c.y,0))}return s})),i=function(t,e,o){return o?"left"===o?t*e/2:"right"===o?t*e/-2:void 0:0};t("getCenterExpos",(function(t){return u(r.globalNodes.centerExpo,t,210)})),t("getLeftExpos",(function(t){return u(r.globalNodes.leftExpo,t,210,"left")})),t("getRightExpos",(function(t){return u(r.globalNodes.rightExpo,t,210,"right")})),t("getHandExpos",(function(t,e){return u(t,e,80)})),t("getGroundExpos",(function(t){return u(t,n(),100)}));e._RF.pop()}}}));

System.register("chunks:///_virtual/LoadingManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index.ts"],(function(r){var e,n,t,a,o,i,s,c,u,p,l,g;return{setters:[function(r){e=r.applyDecoratedDescriptor,n=r.inheritsLoose,t=r.initializerDefineProperty,a=r.assertThisInitialized,o=r.asyncToGenerator,i=r.regeneratorRuntime},function(r){s=r.cclegacy,c=r._decorator,u=r.ProgressBar,p=r.director,l=r.Component},function(r){g=r.waitForSocket}],execute:function(){var f,d,y,h,v;s._RF.push({},"a6f1fi8DXBCuZtULvrumynH","LoadingManager",void 0);var L=c.ccclass,m=c.property;r("LoadingManager",(f=L("LoadingManager"),d=m(u),f((v=e((h=function(r){function e(){for(var e,n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return e=r.call.apply(r,[this].concat(o))||this,t(e,"progressBar",v,a(e)),e}return n(e,r),e.prototype.start=function(){var r=this;p.preloadScene("Duel",(function(e,n){r.progressBar.progress=e/(n+2)}),o(i().mark((function r(){return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,g();case 2:p.loadScene("Duel");case 3:case"end":return r.stop()}}),r)}))))},e}(l)).prototype,"progressBar",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=h))||y));s._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./debug-view-runtime-control.ts","./BoardManager.ts","./CardManager.ts","./Card3D.ts","./DuelManager.ts","./DuelRibbonController.ts","./LoadingManager.ts","./PreviewManager.ts","./TurnController.ts","./UnitManager.ts","./handlers.ts","./index.ts","./sender.ts","./util.ts","./draw.ts","./fight2.ts","./generic.ts","./index3.ts","./reinforce.ts","./summon.ts","./card.ts","./common.ts","./fight.ts","./generic2.ts","./hud.ts","./index2.ts","./preview.ts","./summon2.ts","./animation.ts","./attribute.ts","./command.ts","./helper.ts","./layout.ts","./resources.ts","./system.ts","./types.ts","./Example1.ts","./TextMeshPro.ts","./TmpRichText.ts","./HtmlParser.ts","./TmpAssembler.ts","./TmpFontConfig.ts","./TmpUtils.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/preview.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var t,e,r,i,o;return{setters:[function(n){t=n.asyncToGenerator,e=n.regeneratorRuntime},function(n){r=n.cclegacy,i=n.tween,o=n.Vec3}],execute:function(){r._RF.push({},"d7949a2yi5PeJFE3pf3grSb","preview",void 0);n("raiseUnitPreview",function(){var n=t(e().mark((function n(t,r){var u,a,c;return e().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return u=r.getPosition(),a=u.x>0?-170:170,u.y,c=26,n.abrupt("return",new Promise((function(n){t.setPosition(u.x+a,u.y+c),i(t.getChildByPath("Card")).set({position:new o(0,-15,0),scale:new o(.6,.6,1)}).to(.15,{position:new o(0,0,0)},{easing:"backOut"}).call((function(){return n()})).start()})));case 4:case"end":return n.stop()}}),n)})));return function(t,e){return n.apply(this,arguments)}}()),n("raiseHandPreview",function(){var n=t(e().mark((function n(t,r,u){return e().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return void 0===r&&(r=-12),void 0===u&&(u=.15),n.abrupt("return",new Promise((function(n){i(t.getChildByPath("Card")).set({position:new o(0,r,0)}).to(u,{position:new o(0,0,0)},{easing:"backOut"}).call((function(){return n()})).start()})));case 3:case"end":return n.stop()}}),n)})));return function(t,e,r){return n.apply(this,arguments)}}()),n("raiseHandCard",function(){var n=t(e().mark((function n(t,r,u,a){return e().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return void 0===r&&(r=100),void 0===u&&(u=.1),void 0===a&&(a="front"),n.abrupt("return",new Promise((function(n){i(t.getChildByPath(a)).to(u,{position:new o(0,r,0)},{easing:"cubicInOut"}).call((function(){return n()})).start()})));case 4:case"end":return n.stop()}}),n)})));return function(t,e,r,i){return n.apply(this,arguments)}}());r._RF.pop()}}}));

System.register("chunks:///_virtual/PreviewManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index.mjs_cjs=&original=.js","./helper.ts","./system.ts","./index2.ts","./index.js","./preview.ts"],(function(e){var n,t,i,o,r,s,a,d,c,u,h;return{setters:[function(e){n=e.inheritsLoose},function(e){t=e.cclegacy,i=e._decorator,o=e.Node,r=e.Vec2,s=e.Component},null,function(e){a=e.setCursor,d=e.cardIdFromNode},function(e){c=e.system},null,function(e){u=e.default},function(e){h=e.raiseHandCard}],execute:function(){var p;t._RF.push({},"372f97ULWxO7rz1m5SZQgwe","PreviewManager",void 0);var g=i.ccclass,f=o.EventType,l=u.CardType,v=u.getCard,M=u.selectPlayer;e("PreviewManager",g("PreviewManager")(p=function(e){function t(){for(var n,t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return(n=e.call.apply(e,[this].concat(i))||this).props={},n}n(t,e);var i=t.prototype;return i.start=function(){this.props.card=this.node.getChildByPath("Card"),this.node.on(f.MOUSE_ENTER,this.onMouseEnter.bind(this)),this.node.on(f.MOUSE_LEAVE,this.onMouseLeave.bind(this)),this.node.on(f.MOUSE_DOWN,this.onMouseDown.bind(this)),this.node.on(f.MOUSE_UP,this.onMouseUp.bind(this)),this.node.on(f.MOUSE_MOVE,this.onMouseMove.bind(this))},i.onMouseEnter=function(){this.props.dragging=!1,a("grab")},i.onMouseLeave=function(){a("auto"),this.hidePreview()},i.onMouseDown=function(e){this.props.dragging=!0,this.props.dragOffset=e.getLocation()},i.onMouseUp=function(){this.props.dragging=!1},i.onMouseMove=function(e){if(this.props.dragging&&c.isCommandAble){var n=e.getLocation();if(r.distance(n,this.props.dragOffset)>5){var t=d(c.activeCard),i=v(c.duel.cardMap,t),o=M(c.duel,c.playerIds.me);if(i.kind===l.Hero&&o.perTurnHero<=0)return;this.hidePreview(),c.dragging=!0}}},i.hidePreview=function(){(this.node.setPosition(190,740),c.activeCard)&&(h(c.activeCard,0,.02),c.activeCard.getComponent("cc.UIOpacity").opacity=255)},t}(s))||p);t._RF.pop()}}}));

System.register("chunks:///_virtual/reinforce.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index.mjs_cjs=&original=.js","./index2.ts","./layout.ts","./system.ts","./index.js","./fight.ts"],(function(e){var n,r,t,o,u,i,a;return{setters:[function(e){n=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){t=e.cclegacy},null,null,function(e){o=e.getGroundExpos},function(e){u=e.system},function(e){i=e.default},function(e){a=e.animateRelocate}],execute:function(){t._RF.push({},"d943d7BAUFFSJS5+5iaSflx","reinforce",void 0);var s=i.DuelCommandType;e("playReinforce",function(){var e=n(r().mark((function e(n){var t,i;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.commands,i=[],t.filter((function(e){return e.type===s.CardMove})).filter((function(e){return e.type===s.CardMove})).forEach((function(e){var n,r=e.owner,t=e.target,s=u.cardRefs[null==t||null==(n=t.from)?void 0:n.id];if(s){var c=u.playerIds.me===r?u.globalNodes.playerGroundGuide:u.globalNodes.enemyGroundGuide,l=o(c);i.push(a(s,l[t.to.index]))}})),e.next=6,Promise.all(i);case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());t._RF.pop()}}}));

System.register("chunks:///_virtual/resources.ts",["./rollupPluginModLoBabelHelpers.js","cc","./helper.ts","./system.ts"],(function(e){var n,r,t,u,o,a,c,i;return{setters:[function(e){n=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){t=e.cclegacy,u=e.sys,o=e.resources,a=e.instantiate},function(e){c=e.delay},function(e){i=e.system}],execute:function(){t._RF.push({},"f5ebe4LOQlJEp1F2zBF5UCO","resources",void 0);var s,f,p,d={},v=u.isBrowser;v&&(s=new AudioContext,(p=s.createGain()).connect(s.destination),document.addEventListener("click",(function(){"running"!==s.state&&s.resume()})));var l=function(){var e=n(r().mark((function e(){var n,t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=v?p.gain.value:i.audioSource.volume,t=n;case 2:if(!(t>0)){e.next=9;break}return v?p.gain.value=t:i.audioSource.volume=t,e.next=6,c(100);case 6:t-=.01,e.next=2;break;case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=n(r().mark((function e(n){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===n&&(n=1),t=0;case 2:if(!(t<n)){e.next=9;break}return v?p.gain.value=t:i.audioSource.volume=t,e.next=6,c(50);case 6:t+=.01,e.next=2;break;case 9:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),w=e("playBackgroundSound",function(){var e=n(r().mark((function e(n,t,u){var o,a,c;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=1),void 0===u&&(u=!0),e.next=4,y(n);case 4:return o=e.sent,a=o.clip,c=o.buffer,v?(f&&(f.stop(),f.buffer=null,f.disconnect()),(f=s.createBufferSource()).buffer=c,f.connect(p),f.loop=u,f.start(0)):(i.audioSource.stop(),i.audioSource.clip=a,i.audioSource.play()),e.next=10,x(t);case 10:case"end":return e.stop()}}),e)})));return function(n,r,t){return e.apply(this,arguments)}}()),m=(e("switchBackgroundSound",function(){var e=n(r().mark((function e(n,t){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=1),e.next=3,l();case 3:w(n,t);case 4:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}()),e("playEffectSound",function(){var e=n(r().mark((function e(n,t){var u,o;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=1),e.next=3,y(n);case 3:u=e.sent,o=u.clip,i.audioSource.playOneShot(o,t);case 6:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}()),e("instantiatePrefab",(function(e){return new Promise((function(n,r){o.load(e,(function(e,t){e?r(e):n(a(t))}))}))})),e("bufferFromAsset",function(){var e=n(r().mark((function e(n){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var t=new XMLHttpRequest;t.open("GET",n.nativeUrl,!0),t.responseType="arraybuffer",t.onload=function(){return e(t.response)},t.onerror=function(){return r()},t.send()})));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())),h=e("extractAudioBuffer",function(){var e=n(r().mark((function e(n){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){s.decodeAudioData(n,(function(n){return e(n)}),(function(e){return r(e)}))})));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),y=e("getAudioSource",function(){var e=n(r().mark((function e(t){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,u){var a=d[t];a?e(a):o.load("sound/"+t,n(r().mark((function n(o,a){var c;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!o){n.next=4;break}u(o),n.next=13;break;case 4:if(d[t]={clip:a},!v){n.next=12;break}return n.next=8,m(a);case 8:return c=n.sent,n.next=11,h(c);case 11:d[t].buffer=n.sent;case 12:e(d[t]);case 13:case"end":return n.stop()}}),n)}))))})));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());t._RF.pop()}}}));

System.register("chunks:///_virtual/sender.ts",["cc","./index.mjs_cjs=&original=.js","./lodash.mjs_cjs=&original=.js","./index3.ts","./system.ts","./types.ts","./util.ts","./index.js","./lodash.js"],(function(e){var n,t,o,d,a,s,r;return{setters:[function(e){n=e.cclegacy},null,null,function(e){t=e.replay},function(e){o=e.system},function(e){d=e.GameEventType},function(e){a=e.ws},function(e){s=e.default},function(e){r=e.default}],execute:function(){n._RF.push({},"93bad7fcINC6JyHdkGajEE7","sender",void 0);var c=s.getCardState,u=s.selectHand,i=s.move,l=s.DuelPlace,f=e("send",(function(e,n){var t={routeKey:"game",jwt:o.jwt,type:e,payload:n};a.send(JSON.stringify(t))})),m=(e("sendConnect",(function(){var e,n,t,a,s=new URLSearchParams(location.search).get("jwt"),r=null==(e=localStorage)?void 0:e.getItem("GAME_JWT");if(o.jwt=s||r,o.jwt){var c=(n=o.jwt,t=n.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),a=decodeURIComponent(window.atob(t)),JSON.parse(a)),u=c.userId,i=c.matchId;o.userId=u,o.matchId=i}console.log("System here",o),f(d.ConnectMatch)})),e("sendBundles",(function(e){f(d.SendBundle,e),e.forEach((function(e){o.history.push(e)})),t()}))),p=(e("sendCardSummon",(function(e,n){var t=c(o.duel.stateMap,e),d=i.summonCard(r.cloneDeep(o.duel),{from:{owner:t.owner,id:t.id,place:l.Hand},to:{owner:t.owner,index:n,place:l.Ground}}).commandBundles;m(d)})),e("sendEndTurn",(function(){m(i.endTurn(o.duel).commandBundles)})),e("internalSendCardHover",(function(e,n){var t=c(o.duel.stateMap,e),a=u(o.duel,t.owner).indexOf(e);f(d.CardHover,{index:a,isMouseIn:n})})));e("sendCardHover",r.throttle(p,200));n._RF.pop()}}}));

System.register("chunks:///_virtual/summon.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index.mjs_cjs=&original=.js","./index2.ts","./UnitManager.ts","./helper.ts","./layout.ts","./system.ts","./index.js","./card.ts","./summon2.ts"],(function(e){var n,t,r,a,o,s,u,i,c,l,m,d;return{setters:[function(e){n=e.asyncToGenerator,t=e.regeneratorRuntime},function(e){r=e.cclegacy,a=e.instantiate},null,null,function(e){o=e.UnitManager},function(e){s=e.selectGroundGuide},function(e){u=e.getGroundExpos},function(e){i=e.system},function(e){c=e.default},function(e){l=e.animateGlowOff},function(e){m=e.animatePlayerSummon,d=e.animateEnemySummon}],execute:function(){r._RF.push({},"26489EsRcJABLUB6igMkDxe","summon",void 0);var f=c.DuelCommandType;e("playSummon",function(){var e=n(t().mark((function e(n){var r,c,p,g;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.commands,c=[],p=t().mark((function e(){var n,p,y,h,v,x,b,k,G,w;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=r[g],p=n.type,y=n.owner,h=n.target,p===f.CardMove&&(v=h.from.id,x=y===i.playerIds.me,b=u(s(y)),k=b[h.to.index],G=i.cardRefs[v],(w=a(i.globalNodes.unitTemplate)).getComponent(o).setCardId(v),i.cardRefs[v]=w,x?(w.parent=i.globalNodes.playerGround,l(G),c.push(m(G,w,k))):(w.parent=i.globalNodes.enemyGround,w.getChildByPath("front").active=!1,w.getChildByPath("back").active=!0,c.push(d(G,w,k)),setTimeout((function(){return G.destroy()}),0)));case 3:case"end":return e.stop()}}),e)})),g=0;case 4:if(!(g<r.length)){e.next=9;break}return e.delegateYield(p(),"t0",6);case 6:g+=1,e.next=4;break;case 9:return e.next=11,Promise.all(c);case 11:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());r._RF.pop()}}}));

System.register("chunks:///_virtual/summon2.ts",["cc","./resources.ts","./common.ts"],(function(n){var t,e,o,i,s,u;return{setters:[function(n){t=n.cclegacy,e=n.Vec3,o=n.tween,i=n.Quat},function(n){s=n.playEffectSound},function(n){u=n.shakeGround}],execute:function(){t._RF.push({},"8404fadAkxLCKcq4P5/7/V6","summon",void 0);n("animatePlayerSummon",(function(n,t,i){return new Promise((function(a){var r=n.getPosition().x>i.x?10:-10,c=new e(i.x+r,i.y+200,i.z);o(n).to(.1,{scale:new e(.52,.52,1)},{easing:"backOut"}).call((function(){return s("light-fire",.5)})).to(.4,{scale:new e(.23,.23,1),position:c},{easing:"expoOut"}).call((function(){n.destroy(),o(t).set({position:c,scale:new e(.25,.25,1)}).to(.3,{position:i,scale:new e(.24,.24,1)},{easing:"expoOut"}).call((function(){s("ground-hit"),u(),a()})).start()})).start()}))})),n("animateEnemySummon",(function(n,t,a){return new Promise((function(r){var c=n.getPosition(),l=new e(a.x,a.y+200,a.z),f=i.fromEuler(new i,180,0,0),m=i.fromEuler(new i,0,0,0);o(t).set({position:c,rotation:f}).to(.1,{scale:new e(.5,.5,1)},{easing:"backOut"}).call((function(){return s("light-fire",.5)})).to(.4,{position:l,scale:new e(.23,.23,1),rotation:m},{easing:"expoOut"}).to(.3,{position:a},{easing:"expoOut"}).call((function(){s("ground-hit"),u(),r()})).start()}))})),n("animateGroundAppear",(function(n,t){return new Promise((function(i){o(n).set({scale:new e(.25,.25,1),position:t}).to(.5,{scale:new e(.24,.24,1)}).call((function(){return i()})).start()}))})),n("animateAirSummon",(function(n,t){return new Promise((function(i){var a=1280*Math.random()-640;o(n).set({position:new e(a,t.y>0?600:-600,1)}).to(1,{position:t},{easing:"expoOut"}).call((function(){s("ground-hit"),u(),i()})).start()}))}));t._RF.pop()}}}));

System.register("chunks:///_virtual/system.ts",["cc","./index.mjs_cjs=&original=.js","./lodash.mjs_cjs=&original=.js","./index.js","./lodash.js"],(function(e){var r,t,n;return{setters:[function(e){r=e.cclegacy},null,null,function(e){t=e.default},function(e){n=e.default}],execute:function(){r._RF.push({},"fdf188UsFlB+67e6cyojjyQ","system",void 0);var s=t.defaultSetting,a=t.DuelPhases,u=t.nanoId,i=e("makeDuelProxy",(function(e){var r={};return e.getSubscriptionCount=function(){return Object.keys(r).reduce((function(e,t){return e+Object.keys(r[t]).length}),0)},e.subscribe=function(t,n,s){var a,i=u();r[t]?r[t][i]=n:r[t]=((a={})[i]=n,a);return s&&(t.startsWith("state#")?n(e.stateMap[t.substring(6)]):n(e[t])),function(){delete r[t][i]}},e.stateMap=new Proxy(e.stateMap,{set:function(e,t,s){if(n.isEqual(e[t],s))return!0;var a=r["state#"+t];return a&&Object.keys(a).forEach((function(r){var n;null==(n=a[r])||n.call(a,s,e[t])})),e[t]=s,!0}}),new Proxy(e,{set:function(e,t,s){if(n.isEqual(e[t],s))return!0;var a=r[t];return a&&Object.keys(a).forEach((function(r){var n;null==(n=a[r])||n.call(a,s,e[t])})),e[t]=s,!0}})})),o={id:"default",health:s.initialPlayerHealth,attack:0,defense:0,perTurnHero:s.perTurnHero,perTurnTroop:s.perTurnTroop,perTurnDraw:s.perTurnDraw,perTurnSpell:s.perTurnSpell},c={cardMap:{},stateMap:{},turn:0,phase:a.Draw,phaseOf:"",uniqueCardCount:0,setting:s,firstMover:"",firstPlayer:o,secondPlayer:o,firstDeck:[],secondDeck:[],firstHand:[],secondHand:[],firstGround:[],secondGround:[],firstGrave:[],secondGrave:[]},l=e("system",{userId:"",matchId:"",jwt:"",playerIds:{me:"",enemy:""},duel:i(c),predict:c,isSocketReady:!1,isCommandAble:!1,cardRefs:{},globalNodes:{},history:[],historyLevel:0,previewing:!1,dragging:!1});globalThis.system=l,r._RF.pop()}}}));

System.register("chunks:///_virtual/TextMeshPro.ts",["./rollupPluginModLoBabelHelpers.js","cc","./TmpAssembler.ts","./TmpFontConfig.ts","./TmpUtils.ts"],(function(t){var e,r,o,i,n,a,l,s,p,u,c,h,f,y,_,g,b,m,d,w,O,D,T;return{setters:[function(t){e=t.applyDecoratedDescriptor,r=t.createClass,o=t.inheritsLoose,i=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){a=t.cclegacy,l=t._decorator,s=t.gfx,p=t.Color,u=t.Vec2,c=t.JsonAsset,h=t.HorizontalTextAlignment,f=t.VerticalTextAlignment,y=t.Enum,_=t.Texture2D,g=t.color,b=t.RenderData,m=t.StencilManager,d=t.renderer,w=t.error,O=t.UIRenderer},function(t){D=t.default},function(t){T=t.default},null],execute:function(){var U,k,S,P,M,I,x,C,R,z,E,v,F,G,L,j,A,H,B,X,V,N,W,Y,K,q,Z,J,Q,$,tt,et,rt,ot,it,nt,at,lt,st,pt,ut,ct,ht,ft,yt,_t,gt,bt,mt,dt,wt,Ot,Dt,Tt,Ut,kt,St,Pt,Mt,It,xt,Ct,Rt,zt,Et,vt,Ft,Gt,Lt,jt,At,Ht,Bt,Xt,Vt,Nt,Wt,Yt,Kt,qt,Zt,Jt,Qt,$t,te,ee,re,oe,ie,ne,ae,le,se,pe,ue;a._RF.push({},"110b2HQ0H1MFY83nfU7nvjk","TextMeshPro",void 0);var ce=l.ccclass,he=l.property,fe=l.executeInEditMode,ye=[new s.Attribute(s.AttributeName.ATTR_POSITION,s.Format.RGB32F),new s.Attribute(s.AttributeName.ATTR_TEX_COORD,s.Format.RG32F),new s.Attribute(s.AttributeName.ATTR_COLOR,s.Format.RGBA32F),new s.Attribute(s.AttributeName.ATTR_COLOR2,s.Format.RGBA32F),new s.Attribute("a_texture_idx",s.Format.R32F)],_e=t("TmpOverflow",function(t){return t[t.NONE=0]="NONE",t[t.CLAMP=1]="CLAMP",t[t.ELLIPSIS=2]="ELLIPSIS",t[t.SHRINK=3]="SHRINK",t[t.RESIZE_HEIGHT=4]="RESIZE_HEIGHT",t}({})),ge=t("TmpUniform",(U=ce("TmpUniform"),k=he(p),S=he({tooltip:"文本主体颜色",type:p}),P=he({tooltip:"文本主体厚度",range:[0,1,.01]}),M=he({tooltip:"文本主体柔和度",range:[0,1,.01]}),I=he({tooltip:"是否启用描边效果"}),x=he(p),C=he({tooltip:"描边颜色",type:p,visible:function(){return this._enableOutline}}),R=he({tooltip:"描边厚度",range:[0,1,.01],visible:function(){return this._enableOutline}}),z=he({tooltip:"是否启用阴影效果"}),E=he(p),v=he({tooltip:"阴影颜色",type:p,visible:function(){return this._enableUnderlay}}),F=he(u),G=he({tooltip:"阴影偏移",type:u,range:[-1,1],visible:function(){return this._enableUnderlay}}),L=he({tooltip:"阴影厚度",range:[0,1,.01],visible:function(){return this._enableUnderlay}}),j=he({tooltip:"阴影柔和度",range:[0,1,.01],visible:function(){return this._enableUnderlay}}),A=he({tooltip:"是否启用辉光效果"}),H=he(p),B=he({tooltip:"辉光颜色",type:p,visible:function(){return this._enableGlow}}),X=he({tooltip:"辉光偏移",range:[0,1,.01],visible:function(){return this._enableGlow}}),V=he({tooltip:"辉光向内的厚度",range:[0,1,.01],visible:function(){return this._enableGlow}}),N=he({tooltip:"辉光向外的厚度",range:[0,1,.01],visible:function(){return this._enableGlow}}),W=he({tooltip:"辉光强度",range:[0,1,.01],visible:function(){return this._enableGlow}}),U((q=e((K=function(){function t(){i(this,"_faceColor",q,this),i(this,"_faceDilate",Z,this),i(this,"_faceSoftness",J,this),i(this,"_enableOutline",Q,this),i(this,"_outlineColor",$,this),i(this,"_outlineThickness",tt,this),i(this,"_enableUnderlay",et,this),i(this,"_underlayColor",rt,this),i(this,"_underlayOffset",ot,this),i(this,"_underlayDilate",it,this),i(this,"_underlaySoftness",nt,this),i(this,"_enableGlow",at,this),i(this,"_glowColor",lt,this),i(this,"_glowOffset",st,this),i(this,"_glowInner",pt,this),i(this,"_glowOuter",ut,this),i(this,"_glowPower",ct,this),this._comp=null}return t.prototype.init=function(t){this._comp=t;var e=this._comp.getMaterialInstance(0);this._comp.updateTmpMatFace(e),this._comp.updateTmpMatOutline(e),this._comp.updateTmpMatUnderlay(e),this._comp.updateTmpMatGlow(e)},r(t,[{key:"faceColor",get:function(){return this._faceColor},set:function(t){this._faceColor!==t&&(this._faceColor=t,this._comp&&this._comp.updateTmpMatFace(this._comp.getMaterialInstance(0)))}},{key:"faceDilate",get:function(){return this._faceDilate},set:function(t){this._faceDilate!==t&&(this._faceDilate=t,this._comp&&this._comp.updateTmpMatFace(this._comp.getMaterialInstance(0)))}},{key:"faceSoftness",get:function(){return this._faceSoftness},set:function(t){this._faceSoftness!==t&&(this._faceSoftness=t,this._comp&&this._comp.updateTmpMatFace(this._comp.getMaterialInstance(0)))}},{key:"enableOutline",get:function(){return this._enableOutline},set:function(t){this._enableOutline!==t&&(this._enableOutline=t,this._comp&&this._comp.updateTmpMatOutline(this._comp.getMaterialInstance(0)))}},{key:"outlineColor",get:function(){return this._outlineColor},set:function(t){this._outlineColor!==t&&(this._outlineColor=t,this._comp&&this._comp.updateTmpMatOutline(this._comp.getMaterialInstance(0)))}},{key:"outlineThickness",get:function(){return this._outlineThickness},set:function(t){this._outlineThickness!==t&&(this._outlineThickness=t,this._comp&&this._comp.updateTmpMatOutline(this._comp.getMaterialInstance(0)))}},{key:"enableUnderlay",get:function(){return this._enableUnderlay},set:function(t){this._enableUnderlay!==t&&(this._enableUnderlay=t,this._comp&&this._comp.updateTmpMatUnderlay(this._comp.getMaterialInstance(0)))}},{key:"underlayColor",get:function(){return this._underlayColor},set:function(t){this._underlayColor!==t&&(this._underlayColor=t,this._comp&&this._comp.updateTmpMatUnderlay(this._comp.getMaterialInstance(0)))}},{key:"underlayOffset",get:function(){return this._underlayOffset},set:function(t){this._underlayOffset!==t&&(this._underlayOffset=t,this._comp&&this._comp.updateTmpMatUnderlay(this._comp.getMaterialInstance(0)))}},{key:"underlayDilate",get:function(){return this._underlayDilate},set:function(t){this._underlayDilate!==t&&(this._underlayDilate=t,this._comp&&this._comp.updateTmpMatUnderlay(this._comp.getMaterialInstance(0)))}},{key:"underlaySoftness",get:function(){return this._underlaySoftness},set:function(t){this._underlaySoftness!==t&&(this._underlaySoftness=t,this._comp&&this._comp.updateTmpMatUnderlay(this._comp.getMaterialInstance(0)))}},{key:"enableGlow",get:function(){return this._enableGlow},set:function(t){this._enableGlow!==t&&(this._enableGlow=t,this._comp&&this._comp.updateTmpMatGlow(this._comp.getMaterialInstance(0)))}},{key:"glowColor",get:function(){return this._glowColor},set:function(t){this._glowColor!==t&&(this._glowColor=t,this._comp&&this._comp.updateTmpMatGlow(this._comp.getMaterialInstance(0)))}},{key:"glowOffset",get:function(){return this._glowOffset},set:function(t){this._glowOffset!==t&&(this._glowOffset=t,this._comp&&this._comp.updateTmpMatGlow(this._comp.getMaterialInstance(0)))}},{key:"glowInner",get:function(){return this._glowInner},set:function(t){this._glowInner!==t&&(this._glowInner=t,this._comp&&this._comp.updateTmpMatGlow(this._comp.getMaterialInstance(0)))}},{key:"glowOuter",get:function(){return this._glowOuter},set:function(t){this._glowOuter!==t&&(this._glowOuter=t,this._comp&&this._comp.updateTmpMatGlow(this._comp.getMaterialInstance(0)))}},{key:"glowPower",get:function(){return this._glowPower},set:function(t){this._glowPower!==t&&(this._glowPower=t,this._comp&&this._comp.updateTmpMatGlow(this._comp.getMaterialInstance(0)))}},{key:"comp",get:function(){return this._comp}}]),t}()).prototype,"_faceColor",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return p.WHITE.clone()}}),e(K.prototype,"faceColor",[S],Object.getOwnPropertyDescriptor(K.prototype,"faceColor"),K.prototype),Z=e(K.prototype,"_faceDilate",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),e(K.prototype,"faceDilate",[P],Object.getOwnPropertyDescriptor(K.prototype,"faceDilate"),K.prototype),J=e(K.prototype,"_faceSoftness",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.01}}),e(K.prototype,"faceSoftness",[M],Object.getOwnPropertyDescriptor(K.prototype,"faceSoftness"),K.prototype),Q=e(K.prototype,"_enableOutline",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),e(K.prototype,"enableOutline",[I],Object.getOwnPropertyDescriptor(K.prototype,"enableOutline"),K.prototype),$=e(K.prototype,"_outlineColor",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return g(255,0,0,255)}}),e(K.prototype,"outlineColor",[C],Object.getOwnPropertyDescriptor(K.prototype,"outlineColor"),K.prototype),tt=e(K.prototype,"_outlineThickness",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),e(K.prototype,"outlineThickness",[R],Object.getOwnPropertyDescriptor(K.prototype,"outlineThickness"),K.prototype),et=e(K.prototype,"_enableUnderlay",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),e(K.prototype,"enableUnderlay",[z],Object.getOwnPropertyDescriptor(K.prototype,"enableUnderlay"),K.prototype),rt=e(K.prototype,"_underlayColor",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return g(0,0,0,255)}}),e(K.prototype,"underlayColor",[v],Object.getOwnPropertyDescriptor(K.prototype,"underlayColor"),K.prototype),ot=e(K.prototype,"_underlayOffset",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new u(0,0)}}),e(K.prototype,"underlayOffset",[G],Object.getOwnPropertyDescriptor(K.prototype,"underlayOffset"),K.prototype),it=e(K.prototype,"_underlayDilate",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),e(K.prototype,"underlayDilate",[L],Object.getOwnPropertyDescriptor(K.prototype,"underlayDilate"),K.prototype),nt=e(K.prototype,"_underlaySoftness",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),e(K.prototype,"underlaySoftness",[j],Object.getOwnPropertyDescriptor(K.prototype,"underlaySoftness"),K.prototype),at=e(K.prototype,"_enableGlow",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),e(K.prototype,"enableGlow",[A],Object.getOwnPropertyDescriptor(K.prototype,"enableGlow"),K.prototype),lt=e(K.prototype,"_glowColor",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return g(0,255,0,255)}}),e(K.prototype,"glowColor",[B],Object.getOwnPropertyDescriptor(K.prototype,"glowColor"),K.prototype),st=e(K.prototype,"_glowOffset",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),e(K.prototype,"glowOffset",[X],Object.getOwnPropertyDescriptor(K.prototype,"glowOffset"),K.prototype),pt=e(K.prototype,"_glowInner",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.01}}),e(K.prototype,"glowInner",[V],Object.getOwnPropertyDescriptor(K.prototype,"glowInner"),K.prototype),ut=e(K.prototype,"_glowOuter",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.01}}),e(K.prototype,"glowOuter",[N],Object.getOwnPropertyDescriptor(K.prototype,"glowOuter"),K.prototype),ct=e(K.prototype,"_glowPower",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),e(K.prototype,"glowPower",[W],Object.getOwnPropertyDescriptor(K.prototype,"glowPower"),K.prototype),Y=K))||Y));t("default",(ht=ce("TextMeshPro"),ft=he({multiline:!0}),yt=he(c),_t=he({tooltip:"字体资源\n依赖的纹理请勿打入图集\n在编辑器内拖拽此文件时，纹理必须和此文件处于同一目录下",type:c}),gt=he({type:h}),bt=he({type:h}),mt=he({type:f}),dt=he({type:f}),wt=he({visible:function(){return this._overflow===_e.SHRINK}}),Ot=he({range:[0,1024]}),Dt=he({type:y(_e)}),Tt=he({tooltip:"文本的排版方式",type:y(_e)}),Ut=he({tooltip:"是否启用自动换行",visible:function(){return this._overflow===_e.CLAMP||this._overflow===_e.ELLIPSIS}}),kt=he({tooltip:"是否启用斜体"}),St=he({tooltip:"是否启用下划线"}),Pt=he({tooltip:"下划线高度偏移",visible:function(){return this._enableUnderline}}),Mt=he({tooltip:"是否启用删除线"}),It=he({tooltip:"删除线高度偏移",visible:function(){return this._enableStrikethrough}}),xt=he({tooltip:"是否启用颜色渐变，会和顶点颜色混合为最终的顶点颜色"}),Ct=he(p),Rt=he({tooltip:"左下顶点",type:p,visible:function(){return this._colorGradient}}),zt=he(p),Et=he({tooltip:"右下顶点",type:p,visible:function(){return this._colorGradient}}),vt=he(p),Ft=he({tooltip:"左上顶点",type:p,visible:function(){return this._colorGradient}}),Gt=he(p),Lt=he({tooltip:"右上顶点",type:p,visible:function(){return this._colorGradient}}),jt=he({tooltip:"材质参数",type:ge}),At=he({tooltip:"字体所依赖的纹理",type:_,readonly:!0}),ht(Ht=fe((Xt=e((Bt=function(t){function e(){for(var e,r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o))||this,i(e,"_string",Xt,n(e)),i(e,"_font",Vt,n(e)),i(e,"_horizontalAlign",Nt,n(e)),i(e,"_verticalAlign",Wt,n(e)),i(e,"_actualFontSize",Yt,n(e)),i(e,"_fontSize",Kt,n(e)),i(e,"_lineHeight",qt,n(e)),i(e,"_spacingX",Zt,n(e)),i(e,"_overflow",Jt,n(e)),i(e,"_enableWrapText",Qt,n(e)),i(e,"_enableItalic",$t,n(e)),i(e,"_enableUnderline",te,n(e)),i(e,"_underlineOffset",ee,n(e)),i(e,"_enableStrikethrough",re,n(e)),i(e,"_strikethroughOffset",oe,n(e)),i(e,"_colorGradient",ie,n(e)),i(e,"_colorLB",ne,n(e)),i(e,"_colorRB",ae,n(e)),i(e,"_colorLT",le,n(e)),i(e,"_colorRT",se,n(e)),i(e,"tmpUniform",pe,n(e)),i(e,"textures",ue,n(e)),e._fontConfig=null,e._lettersInfo=[],e._assembler=null,e._colorExtraDirty=!1,e._richTextDeltaX=0,e}o(e,t);var a=e.prototype;return a.editorInit=function(){},a.resetInEditor=function(){},a.onLoad=function(){t.prototype.onLoad.call(this),this.customMaterial||this.resetInEditor(),this.tmpUniform.init(this),!this._fontConfig&&this.font&&this.textures.length>0&&(this._fontConfig=new T(this._font.json,this.textures))},a.onEnable=function(){t.prototype.onEnable.call(this),this._applyFontTexture()},a.lateUpdate=function(t){this._colorExtraDirty&&(this._colorExtraDirty=!1,this._assembler.updateColorExtra(this))},a.requestRenderData=function(t){void 0===t&&(t=0);var e=b.add(ye);return e.initRenderDrawInfo(this,t),this._renderData=e,e},a.updateRenderData=function(t){void 0===t&&(t=!1),t&&(this._flushAssembler(),this.renderData&&(this.renderData.vertDirty=!0),this._applyFontTexture()),this._assembler&&this._assembler.updateRenderData(this)},a._render=function(t){this.commitComp(t,this,this.renderData,this.textures[0],this._assembler,null)},a.commitComp=function(t,e,r,o,i,n){var a,l=0,s=-1;if(r&&r.chunk){if(!r.isValid())return;l=r.dataHash,a=r.material,s=r.chunk.bufferId}e.stencilStage=m.sharedManager.stage;var u=e.stencilStage,c=!0,h=0;if(e.tmpUniform.enableOutline&&(h|=1),e.tmpUniform.enableUnderlay&&(h|=2),e.tmpUniform.enableGlow&&(h|=4),t._currMaterial!==a&&((a instanceof d.MaterialInstance&&t._currMaterial.parent!==a.parent||!(a instanceof d.MaterialInstance)&&t._currMaterial.parent!==a||t._currTmpMatDefine!==h)&&(c=!1),c))for(var f=["texture0","texture1","texture2","texture3","texture4","texture5","texture6","texture7","faceColor","faceDilate","faceSoftness","outlineColor","outlineThickness","underlayColor","underlayOffsetX","underlayOffsetY","underlayDilate","underlaySoftness","glowColor","glowOffset","glowInner","glowOuter","glowPower"],y=e.getRenderMaterial(0),_=0;_<f.length;_++){var g=f[_],b=y.getProperty(g),w=t._currMaterial.getProperty(g);if(!(b instanceof p&&w instanceof p&&b.equals(w))&&b!==w){c=!1;break}}t._currHash===l&&0!==l&&c&&t._currDepthStencilStateStage===u||(t.autoMergeBatches(t._currComponent),r&&!r._isMeshBuffer&&t.updateBuffer(r.vertexFormat,s),t._currTmpMatDefine=h,t._currRenderData=r,t._currHash=r?r.dataHash:0,t._currComponent=e,t._currTransform=n,t._currMaterial=e.getRenderMaterial(0),t._currDepthStencilStateStage=u,t._currLayer=e.node.layer,o?(t._currTexture=o.getGFXTexture(),t._currSampler=o.getGFXSampler(),t._currTextureHash=o.getHash(),t._currSamplerHash=t._currSampler.hash):(t._currTexture=null,t._currSampler=null,t._currTextureHash=0,t._currSamplerHash=0)),i.fillBuffers(e,t)},a._updateColor=function(){t.prototype._updateColor.call(this),this.markForUpdateRenderData()},a.setEntityColor=function(t){},a._canRender=function(){return!(!t.prototype._canRender.call(this)||!this._string)&&!(!this.fontConfig||this.textures.length<=0)},a._flushAssembler=function(){var t=D;this._assembler!==t&&(this.destroyRenderData(),this._assembler=t),this._renderData||this._assembler&&this._assembler.createData&&(this._renderData=this._assembler.createData(this),this._renderData.material=this.material,this._updateColor())},a._applyFontTexture=function(){this.markForUpdateRenderData(),this.textures.length>0&&(this.renderData,this.changeMaterialForDefine(),this._assembler&&this._assembler.updateRenderData(this))},a.changeMaterialForDefine=function(){this.textures.length<=0||this.updateMaterial()},a.updateMaterial=function(){if(this._customMaterial){this.setMaterial(this._customMaterial,0);var t=this.getMaterialInstance(0);this._updateTmpMatTexture(t),this.tmpUniform&&this.tmpUniform.comp&&(this.updateTmpMatFace(t),this.updateTmpMatOutline(t),this.updateTmpMatUnderlay(t),this.updateTmpMatGlow(t))}},a._updateTmpMatTexture=function(t){if(t&&!(this.textures.length<=0)){t.recompileShaders({USE_TEXTURE_LEVEL_1:this.textures.length>0,USE_TEXTURE_LEVEL_2:this.textures.length>1,USE_TEXTURE_LEVEL_3:this.textures.length>2,USE_TEXTURE_LEVEL_4:this.textures.length>4});for(var e=0;e<this.textures.length;e++)t.setProperty("texture"+e,this.textures[e])}},a.updateTmpMatFace=function(t){t&&(t.setProperty("faceColor",this.tmpUniform.faceColor),t.setProperty("faceDilate",this.tmpUniform.faceDilate),t.setProperty("faceSoftness",this.tmpUniform.faceSoftness))},a.updateTmpMatOutline=function(t){t&&(t.recompileShaders({USE_OUTLINE:this.tmpUniform.enableOutline}),this.tmpUniform.enableOutline&&(t.setProperty("outlineColor",this.tmpUniform.outlineColor),t.setProperty("outlineThickness",this.tmpUniform.outlineThickness)))},a.updateTmpMatUnderlay=function(t){t&&(t.recompileShaders({USE_UNDERLAY:this.tmpUniform.enableUnderlay}),this.tmpUniform.enableUnderlay&&(t.setProperty("underlayColor",this.tmpUniform.underlayColor),t.setProperty("underlayOffsetX",this.tmpUniform.underlayOffset.x),t.setProperty("underlayOffsetY",this.tmpUniform.underlayOffset.y),t.setProperty("underlayDilate",this.tmpUniform.underlayDilate),t.setProperty("underlaySoftness",this.tmpUniform.underlaySoftness)))},a.updateTmpMatGlow=function(t){t&&(t.recompileShaders({USE_GLOW:this.tmpUniform.enableGlow}),this.tmpUniform.enableGlow&&(t.setProperty("glowColor",this.tmpUniform.glowColor),t.setProperty("glowOffset",this.tmpUniform.glowOffset),t.setProperty("glowInner",this.tmpUniform.glowInner),t.setProperty("glowOuter",this.tmpUniform.glowOuter),t.setProperty("glowPower",this.tmpUniform.glowPower)))},a.forceUpdateRenderData=function(){this.updateRenderData(!0)},a.setFont=function(t,e){!t||e.length<0?w("params error!"):(this._font=t,this.textures=e,this._fontConfig=new T(this._font.json,this.textures),this.enabledInHierarchy&&this.updateRenderData(!0))},a.isVisible=function(t){return!!this.enabledInHierarchy&&this._assembler.isVisble(this,t)},a.setVisible=function(t,e){this.enabledInHierarchy&&this._assembler.setVisible(this,t,e)},a.getColorExtraVertices=function(t){return this.enabledInHierarchy?this._assembler.getColorExtraVertices(this,t):null},a.setColorExtraVertices=function(t,e){this.enabledInHierarchy&&this._assembler.setColorExtraVertices(this,t,e)},a.getPosVertices=function(t){return this.enabledInHierarchy?this._assembler.getPosVertices(this,t):null},a.setPosVertices=function(t,e){this.enabledInHierarchy&&this._assembler.setPosVertices(this,t,e)},r(e,[{key:"string",get:function(){return this._string},set:function(t){this._string!==t&&(this._string=t,this.markForUpdateRenderData())}},{key:"font",get:function(){return this._font},set:function(t){this._font!==t&&(this._font=t,this._renderData&&(this.destroyRenderData(),this._renderData=null),this.updateRenderData(!0))}},{key:"horizontalAlign",get:function(){return this._horizontalAlign},set:function(t){this._horizontalAlign!==t&&(this._horizontalAlign=t,this.markForUpdateRenderData())}},{key:"verticalAlign",get:function(){return this._verticalAlign},set:function(t){this._verticalAlign!==t&&(this._verticalAlign=t,this.markForUpdateRenderData())}},{key:"actualFontSize",get:function(){return this._actualFontSize}},{key:"bmfontOriginalSize",get:function(){return this.font?this.font.json.size:-1}},{key:"fontSize",get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.markForUpdateRenderData())}},{key:"lineHeight",get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this.markForUpdateRenderData())}},{key:"spacingX",get:function(){return this._spacingX},set:function(t){this._spacingX!==t&&(this._spacingX=t,this.markForUpdateRenderData())}},{key:"overflow",get:function(){return this._overflow},set:function(t){this._overflow!==t&&(this._overflow=t,this.markForUpdateRenderData())}},{key:"enableWrapText",get:function(){return this._enableWrapText},set:function(t){this._enableWrapText!==t&&(this._enableWrapText=t,this.markForUpdateRenderData())}},{key:"enableItalic",get:function(){return this._enableItalic},set:function(t){this._enableItalic!==t&&(this._enableItalic=t,this.markForUpdateRenderData())}},{key:"enableUnderline",get:function(){return this._enableUnderline},set:function(t){this._enableUnderline!==t&&(this._enableUnderline=t,this.markForUpdateRenderData())}},{key:"underlineOffset",get:function(){return this._underlineOffset},set:function(t){this._underlineOffset!==t&&(this._underlineOffset=t,this.markForUpdateRenderData())}},{key:"enableStrikethrough",get:function(){return this._enableStrikethrough},set:function(t){this._enableStrikethrough!==t&&(this._enableStrikethrough=t,this.markForUpdateRenderData())}},{key:"strikethroughOffset",get:function(){return this._strikethroughOffset},set:function(t){this._strikethroughOffset!==t&&(this._strikethroughOffset=t,this.markForUpdateRenderData())}},{key:"colorGradient",get:function(){return this._colorGradient},set:function(t){this._colorGradient!==t&&(this._colorGradient=t,this._colorExtraDirty=!0)}},{key:"colorLB",get:function(){return this._colorLB},set:function(t){this._colorLB!==t&&(this._colorLB=t,this._colorExtraDirty=!0)}},{key:"colorRB",get:function(){return this._colorRB},set:function(t){this._colorRB!==t&&(this._colorRB=t,this._colorExtraDirty=!0)}},{key:"colorLT",get:function(){return this._colorLT},set:function(t){this._colorLT!==t&&(this._colorLT=t,this._colorExtraDirty=!0)}},{key:"colorRT",get:function(){return this._colorRT},set:function(t){this._colorRT!==t&&(this._colorRT=t,this._colorExtraDirty=!0)}},{key:"fontConfig",get:function(){return this._fontConfig}},{key:"lettersInfo",get:function(){return this._lettersInfo}},{key:"richTextDeltaX",get:function(){return this._richTextDeltaX}}]),e}(O)).prototype,"_string",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),e(Bt.prototype,"string",[ft],Object.getOwnPropertyDescriptor(Bt.prototype,"string"),Bt.prototype),Vt=e(Bt.prototype,"_font",[yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),e(Bt.prototype,"font",[_t],Object.getOwnPropertyDescriptor(Bt.prototype,"font"),Bt.prototype),Nt=e(Bt.prototype,"_horizontalAlign",[gt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return h.LEFT}}),e(Bt.prototype,"horizontalAlign",[bt],Object.getOwnPropertyDescriptor(Bt.prototype,"horizontalAlign"),Bt.prototype),Wt=e(Bt.prototype,"_verticalAlign",[mt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return f.TOP}}),e(Bt.prototype,"verticalAlign",[dt],Object.getOwnPropertyDescriptor(Bt.prototype,"verticalAlign"),Bt.prototype),Yt=e(Bt.prototype,"_actualFontSize",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),e(Bt.prototype,"actualFontSize",[wt],Object.getOwnPropertyDescriptor(Bt.prototype,"actualFontSize"),Bt.prototype),e(Bt.prototype,"bmfontOriginalSize",[he],Object.getOwnPropertyDescriptor(Bt.prototype,"bmfontOriginalSize"),Bt.prototype),Kt=e(Bt.prototype,"_fontSize",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 32}}),e(Bt.prototype,"fontSize",[Ot],Object.getOwnPropertyDescriptor(Bt.prototype,"fontSize"),Bt.prototype),qt=e(Bt.prototype,"_lineHeight",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 32}}),e(Bt.prototype,"lineHeight",[he],Object.getOwnPropertyDescriptor(Bt.prototype,"lineHeight"),Bt.prototype),Zt=e(Bt.prototype,"_spacingX",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),e(Bt.prototype,"spacingX",[he],Object.getOwnPropertyDescriptor(Bt.prototype,"spacingX"),Bt.prototype),Jt=e(Bt.prototype,"_overflow",[Dt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return _e.NONE}}),e(Bt.prototype,"overflow",[Tt],Object.getOwnPropertyDescriptor(Bt.prototype,"overflow"),Bt.prototype),Qt=e(Bt.prototype,"_enableWrapText",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),e(Bt.prototype,"enableWrapText",[Ut],Object.getOwnPropertyDescriptor(Bt.prototype,"enableWrapText"),Bt.prototype),$t=e(Bt.prototype,"_enableItalic",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),e(Bt.prototype,"enableItalic",[kt],Object.getOwnPropertyDescriptor(Bt.prototype,"enableItalic"),Bt.prototype),te=e(Bt.prototype,"_enableUnderline",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),e(Bt.prototype,"enableUnderline",[St],Object.getOwnPropertyDescriptor(Bt.prototype,"enableUnderline"),Bt.prototype),ee=e(Bt.prototype,"_underlineOffset",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),e(Bt.prototype,"underlineOffset",[Pt],Object.getOwnPropertyDescriptor(Bt.prototype,"underlineOffset"),Bt.prototype),re=e(Bt.prototype,"_enableStrikethrough",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),e(Bt.prototype,"enableStrikethrough",[Mt],Object.getOwnPropertyDescriptor(Bt.prototype,"enableStrikethrough"),Bt.prototype),oe=e(Bt.prototype,"_strikethroughOffset",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),e(Bt.prototype,"strikethroughOffset",[It],Object.getOwnPropertyDescriptor(Bt.prototype,"strikethroughOffset"),Bt.prototype),ie=e(Bt.prototype,"_colorGradient",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),e(Bt.prototype,"colorGradient",[xt],Object.getOwnPropertyDescriptor(Bt.prototype,"colorGradient"),Bt.prototype),ne=e(Bt.prototype,"_colorLB",[Ct],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return p.WHITE.clone()}}),e(Bt.prototype,"colorLB",[Rt],Object.getOwnPropertyDescriptor(Bt.prototype,"colorLB"),Bt.prototype),ae=e(Bt.prototype,"_colorRB",[zt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return p.WHITE.clone()}}),e(Bt.prototype,"colorRB",[Et],Object.getOwnPropertyDescriptor(Bt.prototype,"colorRB"),Bt.prototype),le=e(Bt.prototype,"_colorLT",[vt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return p.WHITE.clone()}}),e(Bt.prototype,"colorLT",[Ft],Object.getOwnPropertyDescriptor(Bt.prototype,"colorLT"),Bt.prototype),se=e(Bt.prototype,"_colorRT",[Gt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return p.WHITE.clone()}}),e(Bt.prototype,"colorRT",[Lt],Object.getOwnPropertyDescriptor(Bt.prototype,"colorRT"),Bt.prototype),pe=e(Bt.prototype,"tmpUniform",[jt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ge}}),ue=e(Bt.prototype,"textures",[At],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ht=Bt))||Ht)||Ht));a._RF.pop()}}}));

System.register("chunks:///_virtual/TmpAssembler.ts",["cc","./TextMeshPro.ts","./TmpUtils.ts"],(function(t){var e,r,a,i,n,o,h,s,l,f,d,u,c;return{setters:[function(t){e=t.cclegacy,r=t.Color,a=t.Vec3,i=t.Mat4,n=t.misc,o=t.rect,h=t.size,s=t.v2,l=t.log,f=t.HorizontalTextAlignment,d=t.VerticalTextAlignment},function(t){u=t.TmpOverflow},function(t){c=t.default}],execute:function(){e._RF.push({},"83104TeN+tAhp9CufQV0kSY","TmpAssembler",void 0);var g,x=new r(255,255,255,255),v=new a,p=new i,I=r.WHITE,y=n.degreesToRadians(15),m={fontAtlas:null,fontSize:0,lineHeight:0,hAlign:0,vAlign:0,hash:"",margin:0},w=null,_=null,A=o(),b=o(),L=[],C=[],S=[],T=null,E=0,D=0,M=0,F=0,P=0,k=1,O=h(0,0),U="",z=0,R=0,V=0,B=0,H=0,W=0,Q=0,G=!1,X=0,q=0,N=0,K=s(),Y={},J=null,Z=null,j=0,$=t("TmpLetterInfo",(function(){this.valid=!0,this.char="",this.x=0,this.y=0,this.line=0,this.hash="",this.quadsIndex=0,this.visible=!0})),tt=t("default",function(){function t(){}return t.createData=function(t){return t.requestRenderData()},t.fillBuffers=function(t,e){var i=t.node;x.set(t.color),x.a=255*i._uiProps.opacity;var n=t.renderData.chunk,o=t.renderData.data,h=n.vb,s=t.renderData.vertexCount;i.getWorldMatrix(p);for(var l=0,f=0;f<s;f++){var d=o[f];a.set(v,d.x,d.y,0),a.transformMat4(v,v,p),h[l++]=v.x,h[l++]=v.y,h[l++]=v.z,r.toArray(h,x,l+2),r.toArray(h,d.colorExtra,l+6),l+=11}n.bufferId;for(var u=n.vertexOffset,c=n.meshBuffer,g=n.meshBuffer.iData,I=c.indexOffset,y=0,m=s/4;y<m;y++){var w=u+4*y;g[I++]=w,g[I++]=w+1,g[I++]=w+2,g[I++]=w+1,g[I++]=w+3,g[I++]=w+2}c.indexOffset+=t.renderData.indexCount,c.setDirty()},t.updateRenderData=function(t){if(t.renderData&&w!==t&&t.fontConfig&&(t.renderData.vertDirty&&(_=(w=t).node._uiProps.uiTransformComp,t.lettersInfo.length=0,this._updateProperties(t),this._updateContent(),this.updateUVs(t),this.updateColor(t),this.updateTextureIdx(t),w._actualFontSize=z,_.setContentSize(O),w.renderData.vertDirty=!1,w.markForUpdateRenderData(!1),w=null,this._resetProperties()),t.textures.length>0)){var e=t.renderData;e.textureDirty=!1,e.updateRenderData(t,t.textures[0])}},t.updateColor=function(t){},t.updateUVs=function(t){for(var e=t.renderData,r=e.chunk.vb,a=e.vertexCount,i=e.data,n=this.uvOffset,o=0;o<a;o++){var h=i[o];r[n]=h.u,r[n+1]=h.v,n+=this.floatsPerVert}},t.updateTextureIdx=function(t){for(var e=t.renderData,r=e.chunk.vb,a=e.vertexCount,i=e.data,n=this.textureIdxOffset,o=0;o<a;o++){var h=i[o];r[n]=h.textureIdx,n+=this.floatsPerVert}},t._updateProperties=function(t){T=t.fontConfig,U=t.string.toString(),z=t.fontSize,R=T?T.json.size:t.fontSize,k=z/R,V=t.horizontalAlign,B=t.verticalAlign,H=t.spacingX,Q=t.overflow,W=t.lineHeight;var e=_.contentSize;O.width=e.width,O.height=e.height,m.fontAtlas=t.fontConfig,m.lineHeight=W,m.fontSize=z,m.hash="",m.margin=0,Q===u.NONE?(G=!1,O.width+=2*m.margin,O.height+=2*m.margin):Q===u.RESIZE_HEIGHT?(G=!0,O.height+=2*m.margin):G=Q!==u.SHRINK&&t.enableWrapText,this._setupBMFontOverflowMetrics(),t.enableItalic&&(K.x=0,K.y=O.height/2,K=K.rotate(y),O.width+=2*Math.abs(K.x),O.height-=2*Math.abs(O.height/2-K.y)),(t.enableUnderline||t.enableStrikethrough)&&((J=m.fontAtlas.getLetter(95+m.hash))||l("Can't find letter definition in textures. letter: _")),t.overflow===u.ELLIPSIS&&((Z=m.fontAtlas.getLetter(46+m.hash))?j=3*(Z.xAdvance*k+H):(j=0,l("Can't find letter definition in textures. letter: .")))},t._resetProperties=function(){T=null,m.hash="",m.margin=0},t._updateContent=function(){this._computeHorizontalKerningForText(),this._alignText()},t._computeHorizontalKerningForText=function(){U.length;L.length=0},t._alignText=function(){if(D=0,C.length=0,Y={},this._multilineTextWrapByWord(),Q===u.SHRINK&&z>0){var t=k,e=k,r=!1;D>O.height&&(t=O.height/D*k,r=!0);var a=0;C.forEach((function(t){t>a&&(a=t)})),a>O.width&&(e=O.width/a*k,r=!0),k=Math.min(t,e),r&&(z=k*R,D=0,C.length=0,Y={},this._multilineTextWrapByWord())}this._computeAlignmentOffset(),this._updateQuads()},t._multilineTextWrapByWord=function(){return this._multilineTextWrap(this._getFirstWordLen)},t._multilineTextWrapByChar=function(){return this._multilineTextWrap(this._getFirstCharLen)},t._multilineTextWrap=function(t){var e=0,r=!1;Q===u.ELLIPSIS&&Z&&(e=Math.max(1,Math.floor(O.height/W)));for(var a=U.length,i=0,n=0,o=0,h=0,f=0,d=0,g=0,x=null,v=s(0,0),p=0;p<a;){var I=U.charAt(p);if("\n"!==I){for(var _=t(U,p,a),A=d,b=g,S=f,T=n,M=!1,z=0;z<_;++z){var R=p+z;if("\r"!==(I=U.charAt(R)))if(x=m.fontAtlas.getLetterDefinitionForChar(I)){var V=T+x.offsetX*k-m.margin;if(w.enableItalic&&(K.x=0,K.y=x.h*k/2,K=K.rotate(y),V+=Math.abs(K.x)),Q===u.ELLIPSIS&&Z&&V+(x.xAdvance-x.offsetX)*k>N&&(!G||i+1>=e)){this._recordEllipsis(o,v,i),r=!0,f=w.lettersInfo[w.lettersInfo.length-1].x+(Z.xAdvance-Z.offsetX)*k+H-2*m.margin;break}if(G&&N>0&&n>0&&V+(x.xAdvance-x.offsetX)*k>N&&!c.isUnicodeSpace(I)){C.push(f),f=0,i++,n=0,o-=W*this._getFontScale()+0,M=!0;break}v.x=V,v.y=o-x.offsetY*k+m.margin,this._recordLetterInfo(v,I,R,i),R+1<L.length&&R<a-1&&(T+=L[R+1]),S=T+=x.xAdvance*k+H-2*m.margin,w.enableItalic&&(K.x=0,K.y=x.h*k/2,K=K.rotate(y),S+=Math.abs(K.x)),A<v.y&&(A=v.y),b>v.y-x.h*k&&(b=v.y-x.h*k)}else this._recordPlaceholderInfo(R,I),l("Can't find letter definition in textures. letter: "+I);else this._recordPlaceholderInfo(R,I)}if(r)break;M||(n=T,d<A&&(d=A),g>b&&(g=b),h<(f=S)&&(h=f),p+=_)}else{if(Q===u.ELLIPSIS&&Z&&i+1>=e){this._recordEllipsis(o,v,i),r=!0,f=w.lettersInfo[w.lettersInfo.length-1].x+(Z.xAdvance-Z.offsetX)*k+H-2*m.margin;break}C.push(f),f=0,i++,n=0,o-=W*this._getFontScale()+0,this._recordPlaceholderInfo(p,I),p++}}return C.push(f),D=(E=i+1)*W*this._getFontScale(),E>1&&(D+=0*(E-1)),O.width=X,O.height=q,X<=0&&(O.width=parseFloat(h.toFixed(2))+2*m.margin),q<=0&&(O.height=parseFloat(D.toFixed(2))+2*m.margin),F=O.height,P=0,Q!==u.CLAMP&&(d>0&&(F=O.height+d),g<-D&&(P=D+g)),w._richTextDeltaX=n-f,!0},t._getFirstCharLen=function(){return 1},t._getFontScale=function(){return Q===u.SHRINK?k:1},t._getFirstWordLen=function(t,e,r){var a=t.charAt(e);if(c.isUnicodeCJK(a)||"\n"===a||c.isUnicodeSpace(a))return 1;var i=1,n=m.fontAtlas.getLetterDefinitionForChar(a);if(!n)return i;for(var o=n.xAdvance*k+H,h=e+1;h<r&&(a=t.charAt(h),n=m.fontAtlas.getLetterDefinitionForChar(a));++h){if(o+n.offsetX*k+(n.xAdvance-n.offsetX)*k>N&&!c.isUnicodeSpace(a)&&N>0)return i;if(o+=n.xAdvance*k+H,"\n"===a||c.isUnicodeSpace(a)||c.isUnicodeCJK(a))break;i++}return i},t._recordEllipsis=function(t,e,r){for(var a=0,i=w.lettersInfo.length-1;i>=0;){var n=w.lettersInfo[i],o=m.fontAtlas.getLetterDefinitionForChar(n.char),h=o?o.w:0,s=o?o.xAdvance:0,l=o?o.offsetX:0,f=n.x+h*k-m.margin;if(a=n.x+(s-l)*k+H-2*m.margin,N>=f+j)break;i--,w.lettersInfo.pop()}i<0&&(a=0),e.y=t-Z.offsetY*k+m.margin;for(var d=1;d<=3;d++)e.x=a+Z.offsetX*k-m.margin,this._recordLetterInfo(e,".",i+d,r),a+=Z.xAdvance*k+H-2*m.margin},t._recordPlaceholderInfo=function(t,e){if(t>=w.lettersInfo.length){var r=new $;w.lettersInfo.push(r)}w.lettersInfo[t].char=e,w.lettersInfo[t].hash=e.charCodeAt(0)+m.hash,w.lettersInfo[t].valid=!1},t._recordLetterInfo=function(t,e,r,a){if(r>=w.lettersInfo.length){var i=new $;w.lettersInfo.push(i)}var n=e.charCodeAt(0)+m.hash;w.lettersInfo[r].line=a,w.lettersInfo[r].char=e,w.lettersInfo[r].hash=n,w.lettersInfo[r].valid=m.fontAtlas.getLetter(n).valid,w.lettersInfo[r].x=t.x,w.lettersInfo[r].y=t.y},t._computeAlignmentOffset=function(){switch(S.length=0,V){case f.LEFT:for(var t=0;t<E;++t)S.push(0);break;case f.CENTER:for(var e=0,r=C.length;e<r;e++)S.push((O.width-C[e])/2);break;case f.RIGHT:for(var a=0,i=C.length;a<i;a++)S.push(O.width-C[a])}if(M=O.height,B!==d.TOP){var n=O.height-D+W*this._getFontScale()-R*k;B===d.BOTTOM?M-=n:M-=n/2}},t._setupBMFontOverflowMetrics=function(){var t=O.width,e=O.height;Q===u.RESIZE_HEIGHT&&(e=0),Q===u.NONE&&(t=0,e=0),X=t,q=e,N=t},t._updateQuads=function(){var t=w.renderData;t.dataLength=0,t.resize(0,0);for(var e=_.anchorPoint,r=O,a=e.x*r.width,i=e.y*r.height,n=0,o=0,h=w.lettersInfo.length;o<h;++o){var s=w.lettersInfo[o];if(!s)break;if(s.valid){s.quadsIndex=n;var l=m.fontAtlas.getLetter(s.hash);A.height=l.h,A.width=l.w,A.x=l.u,A.y=l.v;var f=s.y+M;if(q>0&&Q===u.CLAMP){if(f>F){var d=f-F;A.y+=d/k,A.height-=d/k,f-=d}f-A.height*k<P&&(A.height=f<P?0:(f-P)/k)}var x=s.x+S[s.line];if(X>0&&Q===u.CLAMP&&(x<0&&(A.x+=-x/k,A.width-=-x/k,x=0),x+A.width*k>O.width)){var v=x+A.width*k-O.width;A.width-=v/k}if(A.height>0&&A.width>0&&(b.x=x-a,b.y=f-i,b.width=A.width*k,b.height=A.height*k,this.appendQuad(w,l.textureId,A,b),n++,J&&(w.enableUnderline||w.enableStrikethrough)&&!c.isUnicodeSpace(s.char))){var p=Y[s.line];p?p.last<o&&(p.last=o):Y[s.line]={lineIndex:s.line,first:o,last:o}}}}J&&(w.enableUnderline&&this._updateLineQuads(a,i,-z+w.underlineOffset*k),w.enableStrikethrough&&this._updateLineQuads(a,i,-z/2+w.strikethroughOffset*k)),this.updateColorExtra(w);var I=t.indexCount;this.createQuadIndices(I),t.chunk.setIndexBuffer(g)},t.createQuadIndices=function(t){if(t%6==0){var e=t/6;g=null,g=new Uint16Array(t);for(var r=0,a=0;a<e;a++)g[r++]=0+4*a,g[r++]=1+4*a,g[r++]=2+4*a,g[r++]=1+4*a,g[r++]=3+4*a,g[r++]=2+4*a}else console.error("illegal index count!")},t._updateLineQuads=function(t,e,r){for(var a in Y){var i=Y[a],n=i.lineIndex,o=i.first,h=i.last>0?i.last:o,s=w.lettersInfo[o];if(s.valid){var l=w.lettersInfo[h],f=m.fontAtlas.getLetter(s.hash),d=m.fontAtlas.getLetter(l.hash),c=l.x+d.w*k-s.x,g=c>=J.w*k?J.w*k/3:c/2,x=g,v=c-g-x,p=s.x+S[n],I=p+g+v,y=p+g;A.height=J.h,A.width=g/k,A.x=J.u,A.y=J.v;var _=s.y+M+f.offsetY*k+r;if(q>0){if(_>F){var L=_-F;A.y+=L,A.height-=L,_-=L}_-J.h*k<P&&Q===u.CLAMP&&(A.height=_<P?0:(_-P)/k)}A.height>0&&A.width>0&&(b.x=p-t,b.y=_-e,b.width=g,b.height=A.height*k,this.appendQuad(w,J.textureId,A,b)),A.width=x/k,A.x=J.u+J.w-A.width,A.height>0&&A.width>0&&(b.x=I-t,b.y=_-e,b.width=x,b.height=A.height*k,this.appendQuad(w,J.textureId,A,b)),v>0&&(A.width=J.w-2*g/k,A.x=J.u+A.width,A.height>0&&A.width>0&&(b.x=y-t,b.y=_-e,b.width=v,b.height=A.height*k,this.appendQuad(w,J.textureId,A,b)))}}},t.appendQuad=function(t,e,r,a){var i=t.renderData;if(i){var n=i.dataLength;i.dataLength+=4,i.resize(i.dataLength,i.dataLength/2*3);var o,h,s,l,f=i.data,d=m.fontAtlas.getTexture(e),u=d.width,c=d.height,g=r.width,x=r.height;o=r.x/u,s=(r.x+g)/u,h=(r.y+x)/c,l=r.y/c,f[n].u=o,f[n].v=h,f[n+1].u=s,f[n+1].v=h,f[n+2].u=o,f[n+2].v=l,f[n+3].u=s,f[n+3].v=l,o=a.x,s=a.x+a.width,h=a.y-a.height,l=a.y,this.appendVerts(t,f,n,o,s,h,l);for(var v=0;v<4;v++)f[n+v].colorExtra=I.clone();for(var p=0;p<4;p++)f[n+p].textureIdx=e}},t.appendVerts=function(t,e,r,a,i,n,o){t.enableItalic?(K.x=0,K.y=(o-n)/2,K=K.rotate(y),e[r].x=a-Math.abs(K.x),e[r].y=n+Math.abs((o-n)/2-K.y),e[r+1].x=i-Math.abs(K.x),e[r+1].y=n+Math.abs((o-n)/2-K.y),e[r+2].x=a+Math.abs(K.x),e[r+2].y=o-Math.abs((o-n)/2-K.y),e[r+3].x=i+Math.abs(K.x),e[r+3].y=o-Math.abs((o-n)/2-K.y)):(e[r].x=a,e[r].y=n,e[r+1].x=i,e[r+1].y=n,e[r+2].x=a,e[r+2].y=o,e[r+3].x=i,e[r+3].y=o)},t.updateColorExtra=function(t){var e=t.renderData.data;if(e&&!(e.length<=0))for(var r=0;r<t.lettersInfo.length;r++){var a=t.lettersInfo[r];if(a.valid&&!c.isUnicodeSpace(a.char)){var i=a.visible?1:0,n=4*a.quadsIndex;if(e.length<n+4)break;x.set(I),x.a*=i,t.colorGradient&&x.multiply(t.colorLB),e[n].colorExtra.set(x),x.set(I),x.a*=i,t.colorGradient&&x.multiply(t.colorRB),e[n+1].colorExtra.set(x),x.set(I),x.a*=i,t.colorGradient&&x.multiply(t.colorLT),e[n+2].colorExtra.set(x),x.set(I),x.a*=i,t.colorGradient&&x.multiply(t.colorRT),e[n+3].colorExtra.set(x)}}},t.isVisble=function(t,e){var r=t.lettersInfo[e];return r&&r.valid&&r.visible&&!c.isUnicodeSpace(r.char)},t.setVisible=function(t,e,r){var a=t.lettersInfo[e];if(a&&this.isVisble(t,e)!==r&&a.visible!==r&&!c.isUnicodeSpace(a.char)){var i=4*a.quadsIndex,n=t.renderData.data;if(n&&!(n.length<i+4)){a.visible=r;var o=r?1:0;x.set(I),x.a*=o,t.colorGradient&&x.multiply(t.colorLB),n[i].colorExtra.set(x),x.set(I),x.a*=o,t.colorGradient&&x.multiply(t.colorRB),n[i+1].colorExtra.set(x),x.set(I),x.a*=o,t.colorGradient&&x.multiply(t.colorLT),n[i+2].colorExtra.set(x),x.set(I),x.a*=o,t.colorGradient&&x.multiply(t.colorRT),n[i+3].colorExtra.set(x)}}},t.getColorExtraVertices=function(t,e){var r=t.lettersInfo[e];if(!r||!r.valid)return null;var a=4*r.quadsIndex,i=t.renderData.data;if(i&&!(i.length<a+4)){for(var n=[],o=0;o<4;o++){var h=i[a+o].colorExtra.clone();n.push(h)}return n}},t.setColorExtraVertices=function(t,e,r){var a=t.lettersInfo[e];if(a&&a.valid&&4===r.length&&!c.isUnicodeSpace(a.char)){var i=4*a.quadsIndex,n=t.renderData.data;if(n&&!(n.length<i+4))for(var o=0;o<4;o++)n[i+o].colorExtra.set(r[o])}},t.getPosVertices=function(t,e){var r=t.lettersInfo[e];if(!r||!r.valid)return null;var i=4*r.quadsIndex,n=t.renderData.data;if(n&&!(n.length<i+4)){for(var o=[],h=0;h<4;h++)o.push(new a(n[i+h].x,n[i+h].y,n[i+h].z));return o}},t.setPosVertices=function(t,e,r){var a=t.lettersInfo[e];if(a&&a.valid&&4===r.length&&!c.isUnicodeSpace(a.char)){var i=4*a.quadsIndex,n=t.renderData.data;if(n&&!(n.length<i+4))for(var o=0;o<4;o++)n[i+o].x=r[o].x,n[i+o].y=r[o].y,n[i+o].z=r[o].z}},t}());tt.floatsPerVert=14,tt.verticesCount=4,tt.indicesCount=6,tt.uvOffset=3,tt.colorOffset=5,tt.colorExtraOffset=9,tt.textureIdxOffset=13,e._RF.pop()}}}));

System.register("chunks:///_virtual/TmpFontConfig.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,i,n;return{setters:[function(t){e=t.createClass},function(t){i=t.cclegacy,n=t.js}],execute:function(){i._RF.push({},"46a178eVaVOxZBFNDH/dmfz","TmpFontConfig",void 0);var r=t("TmpFontLetter",(function(){this.u=0,this.v=0,this.w=0,this.h=0,this.offsetX=0,this.offsetY=0,this.textureId=0,this.valid=!1,this.xAdvance=0}));t("default",function(){function t(t,e){var i=this;this._letterDefinitions={},this._textures={},this._json=null,this._json=t,e.forEach((function(t,e){i._textures[e]=t})),t.charData.forEach((function(t){var e=new r;e.offsetX=t.xoffset,e.offsetY=t.yoffset,e.w=t.width,e.h=t.height,e.u=t.x,e.v=t.y,e.textureId=t.page,e.valid=!0,e.xAdvance=t.xadvance,i.addLetterDefinitions(t.id,e)}))}var i=t.prototype;return i.addTexture=function(t,e){this._textures[t]=e},i.addLetterDefinitions=function(t,e){this._letterDefinitions[t]=e},i.cloneLetterDefinition=function(){var t={};for(var e in this._letterDefinitions){var i=new r;n.mixin(i,this._letterDefinitions[e]),t[e]=i}return t},i.getTexture=function(t){return this._textures[t]},i.getLetter=function(t){return this._letterDefinitions[t]},i.getLetterDefinitionForChar=function(t){var e=t.charCodeAt(0);return this._letterDefinitions.hasOwnProperty(e)?this._letterDefinitions[e]:null},i.clear=function(){this._letterDefinitions={}},e(t,[{key:"json",get:function(){return this._json}}]),t}());i._RF.pop()}}}));

System.register("chunks:///_virtual/TmpRichText.ts",["./rollupPluginModLoBabelHelpers.js","cc","./env","./TextMeshPro.ts","./HtmlParser.ts","./TmpUtils.ts"],(function(t){var e,i,n,o,r,a,s,l,h,u,c,f,p,_,g,d,m,y,b,v,C,T,x,A,L,O,S,z,H;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,o=t.assertThisInitialized,r=t.createForOfIteratorHelperLoose,a=t.createClass},function(t){s=t.cclegacy,l=t._decorator,h=t.js,u=t.isValid,c=t.JsonAsset,f=t.HorizontalTextAlignment,p=t.VerticalTextAlignment,_=t.SpriteAtlas,g=t.Material,d=t.Texture2D,m=t.NodeEventType,y=t.Node,b=t.Component,v=t.UITransform,C=t.Sprite,T=t.warnID,x=t.Color,A=t.v2,L=t.CCObject},function(t){O=t.DEV},function(t){S=t.default},function(t){z=t.HtmlTextParser},function(t){H=t.default}],execute:function(){var I,w,E,P,W,D,k,U,R,F,N,X,B,G,M,j,V,Y,J,K,q,Q,Z,$,tt,et;s._RF.push({},"cd6a1T8yVBMCqKxdsw6LjB6","TmpRichText",void 0);var it=l.ccclass,nt=l.property,ot=l.disallowMultiple,rt=l.executeInEditMode,at="RICHTEXT_CHILD",st="RICHTEXT_Image_CHILD",lt=new z,ht=new h.Pool((function(t){return!!u(t.node)}),20),ut=new h.Pool((function(t){return u(t.node)}),10);function ct(t){return{node:new y(t),comp:null,lineCount:0,styleIndex:0,imageOffset:"",clickParam:"",clickHandler:"",type:t}}function ft(t,e,i){var n;t===at?n=ht._get():t===st&&(n=ut._get());var o=(n=n||ct(t)).node;return o||(o=new y(t)),o.hideFlags|=L.Flags.DontSave|L.Flags.HideInHierarchy,t===st?(n.comp=o.getComponent(C)||o.addComponent(C),n.comp.spriteFrame=e,n.comp.type=C.Type.SLICED,n.comp.sizeMode=C.SizeMode.CUSTOM):(n.comp=o.getComponent(S)||o.addComponent(S),i&&(n.comp.customMaterial=i),n.comp.string=e,n.comp.horizontalAlign=f.LEFT,n.comp.verticalAlign=p.TOP,n.comp.underlineHeight=2),o.setPosition(0,0,0),o._uiProps.uiTransformComp.setAnchorPoint(.5,.5),n.node=o,n.lineCount=0,n.styleIndex=0,n.imageOffset="",n.clickParam="",n.clickHandler="",n}t("default",(I=nt({multiline:!0}),w=nt(c),E=nt({tooltip:O,type:c}),P=nt({type:f}),W=nt({type:f}),D=nt({type:p}),k=nt({type:p}),U=nt({range:[0,1024]}),R=nt({tooltip:O}),F=nt(_),N=nt(_),X=nt(g),B=nt({tooltip:O,type:d,readonly:!0}),it(G=ot(G=rt((j=e((M=function(t){function e(){for(var e,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,n(e,"_string",j,o(e)),n(e,"_font",V,o(e)),n(e,"_horizontalAlign",Y,o(e)),n(e,"_verticalAlign",J,o(e)),n(e,"_fontSize",K,o(e)),n(e,"_maxWidth",q,o(e)),n(e,"_lineHeight",Q,o(e)),n(e,"_imageAtlas",Z,o(e)),n(e,"_handleTouchEvent",$,o(e)),n(e,"material",tt,o(e)),n(e,"textures",et,o(e)),e._textArray=[],e._segments=[],e._labelSegmentsCache=[],e._linesWidth=[],e._lineOffsetX=0,e._lineCount=1,e._labelWidth=0,e._labelHeight=0,e._layoutDirty=!0,e._labelChildrenNum=0,e._labelContent=null,e._imageContent=null,e}i(e,t);var s=e.prototype;return s.editorInit=function(){},s.resetInEditor=function(){},s.onRestore=function(){},s.onEnable=function(){this.handleTouchEvent&&this._addEventListeners(),this._onFontLoaded(),this._activateChildren(!0)},s.onDisable=function(){this.handleTouchEvent&&this._removeEventListeners(),this._activateChildren(!1)},s.onLoad=function(){this.node.on(m.LAYER_CHANGED,this._applyLayer,this)},s.onDestroy=function(){for(var t,e=r(this._segments);!(t=e()).done;){var i=t.value;i.node.removeFromParent(),i.type===at?ht.put(i):i.type===st&&ut.put(i)}this.node.off(m.ANCHOR_CHANGED,this._updateRichTextPosition,this),this.node.off(m.LAYER_CHANGED,this._applyLayer,this)},s.start=function(){this._onFontLoaded(),this.node.on(m.ANCHOR_CHANGED,this._updateRichTextPosition,this)},s._addEventListeners=function(){this.node.on(y.EventType.TOUCH_END,this._onTouchEnded,this)},s._removeEventListeners=function(){this.node.off(y.EventType.TOUCH_END,this._onTouchEnded,this)},s._updateLabelSegmentTextAttributes=function(){var t=this;this._segments.forEach((function(e){t._applyTextAttribute(e)}))},s._createFontLabel=function(t){return ft(at,t,this.material)},s._createImage=function(t){return ft(st,t)},s._onFontLoaded=function(){this._layoutDirty=!0,this._updateRichText()},s.SplitLongStringApproximatelyIn2048=function(t,e){var i=[];if(this._calculateSize(e,t).x<2048)i.push(t);else for(var n=t.split("\n"),o=0;o<n.length;o++){if(this._calculateSize(e,n[o]).x<2048)i.push(n[o]);else{var r=this.splitLongStringOver2048(n[o],e);i.push.apply(i,r)}}return i},s.splitLongStringOver2048=function(t,e){for(var i=[],n=t,o=0,r=n.length/2,a=n.substring(o,r),s=n.substring(r),l=this._calculateSize(e,a),h=(this._calculateSize(e,s),1*this.maxWidth);l.x>h;){if((r/=2)<1){r*=2;break}a=a.substring(o,r),s=n.substring(r),l=this._calculateSize(e,a)}for(var u=1e3,c=1;u&&o<t.length;){for(;u&&l.x<h;){var f=H.getEnglishWordPartAtFirst(s);f&&f.length>0&&(c=f[0].length),r+=c,a=n.substring(o,r),s=n.substring(r),l=this._calculateSize(e,a),u--}for(;u&&a.length>=2&&l.x>h;)r-=c,a=n.substring(o,r),l=this._calculateSize(e,a),c=1,u--;if(a.length>=2){var p=H.getEnglishWordPartAtLast(a);p&&p.length>0&&a!==p[0]&&(r-=p[0].length,a=n.substring(o,r))}if(i.push(a),o=r,r+=a.length,a=n.substring(o,r),s=n.substring(r),u--,this._calculateSize(e,s).x<2048){o=t.length,r=t.length,a=s,i.push(a);break}l=this._calculateSize(e,a)}return i},s._measureText=function(t,e){var i=this,n=function(e){return i._calculateSize(t,e).width};return e?n(e):n},s._calculateSize=function(t,e){var i;return 0===this._labelSegmentsCache.length?(i=this._createFontLabel(e),this._labelSegmentsCache.push(i)):(i=this._labelSegmentsCache[0]).node.getComponent(S).string=e,i.styleIndex=t,this._applyTextAttribute(i),i.node._uiProps.uiTransformComp.contentSize},s._onTouchEnded=function(t){for(var e,i=this,n=this.node.getComponents(b),o=function(){var o=e.value,r=o.clickHandler,a=o.clickParam;r&&i._containsTouchLocation(o,t.touch.getUILocation())&&(n.forEach((function(e){var i=e[r];e.enabledInHierarchy&&i&&i.call(e,t,a)})),t.propagationStopped=!0)},a=r(this._segments);!(e=a()).done;)o()},s._containsTouchLocation=function(t,e){var i=t.node.getComponent(v);return!!i&&i.getBoundingBoxToWorld().contains(e)},s._resetContent=function(t){if(t)for(var e=t.children,i=e.length-1;i>=0;i--){var n=e[i];if(n.name===at||n.name===st){n.parent===t?n.parent=null:e.splice(i,1);var o=ct(n.name);o.node=n,n.name===at?(o.comp=n.getComponent(S),ht.put(o)):(o.comp=n.getComponent(C),ut.put(o)),this._labelChildrenNum--}}},s._resetState=function(){this._resetContent(this._labelContent),this._resetContent(this._imageContent),this._segments.length=0,this._labelSegmentsCache.length=0,this._linesWidth.length=0,this._lineOffsetX=0,this._lineCount=1,this._labelWidth=0,this._labelHeight=0,this._layoutDirty=!0},s._activateChildren=function(t){this.node.children.forEach((function(e){for(var i=e.children.length-1;i>=0;i--){var n=e.children[i];n.name!==at&&n.name!==st||(n.active=t)}}))},s._addLabelSegment=function(t,e){var i;if(0===this._labelSegmentsCache.length)i=this._createFontLabel(t);else{var n=(i=this._labelSegmentsCache.pop()).node.getComponent(S);n&&(n.string=t)}var o=i.comp;return o.verticalAlign!==this._verticalAlign&&(o.verticalAlign=this._verticalAlign),i.styleIndex=e,i.lineCount=this._lineCount,i.node._uiProps.uiTransformComp.setAnchorPoint(0,0),i.node.layer=this.node.layer,this.labelContent.insertChild(i.node,this._labelChildrenNum++),this._applyTextAttribute(i),this._segments.push(i),i},s._updateRichTextWithMaxWidth=function(t,e,i){var n=e;if(this._lineOffsetX>0&&n+this._lineOffsetX>this._maxWidth)for(var o=0;this._lineOffsetX<=this._maxWidth;){var r=this._getFirstWordLen(t,o,t.length),a=t.substr(o,r),s=this._measureText(i,a);if(!(this._lineOffsetX+s<=this._maxWidth)){if(o>0){var l=t.substr(0,o);this._addLabelSegment(l,i),t=t.substr(o,t.length),n=this._measureText(i,t)}this._updateLineInfo();break}this._lineOffsetX+=s,o+=r}if(n>this._maxWidth)for(var h=H.fragmentText(t,n,this._maxWidth,this._measureText(i)),u=0;u<h.length;++u){var c=h[u],f=this._addLabelSegment(c,i).node._uiProps.uiTransformComp.contentSize;this._lineOffsetX+=f.width,h.length>1&&u<h.length-1&&this._updateLineInfo()}else this._lineOffsetX+=n,this._addLabelSegment(t,i)},s._isLastComponentCR=function(t){return t.length-1===t.lastIndexOf("\n")},s._updateLineInfo=function(){this._linesWidth.push(this._lineOffsetX),this._lineOffsetX=0,this._lineCount++},s._needsUpdateTextLayout=function(t){if(this._layoutDirty||!this._textArray||!t)return!0;if(this._textArray.length!==t.length)return!0;for(var e=0;e<this._textArray.length;e++){var i=this._textArray[e],n=t[e];if(i.text!==n.text)return!0;var o=i.style,r=n.style;if(o){if(r){if(!!r.outline!=!!o.outline)return!0;if(o.size!==r.size||o.italic!==r.italic||o.isImage!==r.isImage)return!0;if(o.src!==r.src||o.imageAlign!==r.imageAlign||o.imageHeight!==r.imageHeight||o.imageWidth!==r.imageWidth||o.imageOffset!==r.imageOffset)return!0}else if(o.size||o.italic||o.isImage||o.outline)return!0}else if(r&&(r.size||r.italic||r.isImage||r.outline))return!0}return!1},s._addRichTextImageElement=function(t){if(t.style){var e=t.style,i=e.src,n=this._imageAtlas&&i&&this._imageAtlas.getSpriteFrame(i);if(n){var o=this._createImage(n);o.comp;switch(e.imageAlign){case"top":o.node._uiProps.uiTransformComp.setAnchorPoint(0,1);break;case"center":o.node._uiProps.uiTransformComp.setAnchorPoint(0,.5);break;default:o.node._uiProps.uiTransformComp.setAnchorPoint(0,0)}e.imageOffset&&(o.imageOffset=e.imageOffset),o.node.layer=this.node.layer,this.imageContent.insertChild(o.node,this._labelChildrenNum++),this._segments.push(o);var r=n.rect.clone(),a=1,s=r.width,l=r.height,h=e.imageWidth||0,u=e.imageHeight||0;u>0?(s*=a=u/l,l*=a):(s*=a=this._lineHeight/l,l*=a),h>0&&(s=h),this._maxWidth>0?(this._lineOffsetX+s>this._maxWidth&&this._updateLineInfo(),this._lineOffsetX+=s):(this._lineOffsetX+=s,this._lineOffsetX>this._labelWidth&&(this._labelWidth=this._lineOffsetX)),o.node._uiProps.uiTransformComp.setContentSize(s,l),o.lineCount=this._lineCount,o.clickHandler="",o.clickParam="";var c=e.event;c&&(o.clickHandler=c.click,o.clickParam=c.param)}else T(4400)}},s._updateRichText=function(){if(this.enabledInHierarchy){var t=lt.parse(this._string);if(!this._needsUpdateTextLayout(t))return this._textArray=t.slice(),void this._updateLabelSegmentTextAttributes();this._textArray=t.slice(),this._resetState();for(var e,i=!1,n=0;n<this._textArray.length;++n){var o=this._textArray[n],r=o.text;if(void 0!==r){if(""===r){if(o.style&&o.style.isNewLine){this._updateLineInfo();continue}if(o.style&&o.style.isImage&&this._imageAtlas){this._addRichTextImageElement(o);continue}}for(var a=(r=this.SplitLongStringApproximatelyIn2048(r,n).join("\n")).split("\n"),s=0;s<a.length;++s){var l=a[s];if(""!==l)if(i=!1,this._maxWidth>0){var h=this._measureText(n,l);this._updateRichTextWithMaxWidth(l,h,n),a.length>1&&s<a.length-1&&this._updateLineInfo()}else e=this._addLabelSegment(l,n),this._lineOffsetX+=e.node._uiProps.uiTransformComp.width,this._lineOffsetX>this._labelWidth&&(this._labelWidth=this._lineOffsetX),a.length>1&&s<a.length-1&&this._updateLineInfo();else{if(this._isLastComponentCR(r)&&s===a.length-1)continue;this._updateLineInfo(),i=!0}}}}i||this._linesWidth.push(this._lineOffsetX),this._maxWidth>0&&(this._labelWidth=this._maxWidth),this._labelHeight=(this._lineCount+.26)*this._lineHeight,this.node._uiProps.uiTransformComp.setContentSize(this._labelWidth,this._labelHeight),this._updateRichTextPosition(),this._layoutDirty=!1}},s._getFirstWordLen=function(t,e,i){var n=t.charAt(e);if(H.isUnicodeCJK(n)||H.isUnicodeSpace(n))return 1;for(var o=1,r=e+1;r<i&&(n=t.charAt(r),!H.isUnicodeSpace(n)&&!H.isUnicodeCJK(n));++r)o++;return o},s._updateRichTextPosition=function(){for(var t=0,e=1,i=this._lineCount,n=this.node._uiProps.uiTransformComp,o=n.anchorX,r=n.anchorY,a=0;a<this._segments.length;++a){var s=this._segments[a],l=s.lineCount;l>e&&(t=0,e=l);var h=this._labelWidth*(.5*this._horizontalAlign-o);switch(this._horizontalAlign){case f.LEFT:break;case f.CENTER:h-=this._linesWidth[l-1]/2;break;case f.RIGHT:h-=this._linesWidth[l-1]}var u=s.node.position;if(s.node.setPosition(t+h,this._lineHeight*(i-l)-this._labelHeight*r,u.z),l===e){t+=s.node._uiProps.uiTransformComp.width;var c=s.node.getComponent(S);c&&c.richTextDeltaX&&(t+=c.richTextDeltaX)}if(s.node.getComponent(C)){var p=s.node.position.clone(),_=this._lineHeight,g=1.26*this._lineHeight;switch(s.node._uiProps.uiTransformComp.anchorY){case 1:p.y+=_+(g-_)/2;break;case.5:p.y+=g/2;break;default:p.y+=(g-_)/2}if(s.imageOffset){var d=s.imageOffset.split(",");if(1===d.length&&d[0]){var m=parseFloat(d[0]);Number.isInteger(m)&&(p.y+=m)}else if(2===d.length){var y=parseFloat(d[0]),b=parseFloat(d[1]);Number.isInteger(y)&&(p.x+=y),Number.isInteger(b)&&(p.y+=b)}}s.node.position=p}}},s._convertLiteralColorValue=function(t){var e=t.toUpperCase();if(x[e])return x[e];var i=0===t.indexOf("#")?t.substring(1):t,n=parseInt(i.substring(0,2),16)||0,o=parseInt(i.substring(2,4),16)||0,r=parseInt(i.substring(4,6),16)||0,a=parseInt(i.substring(6,8),16);return Number.isNaN(a)&&(a=255),new x(n,o,r,a)},s._applyTextAttribute=function(t){var e,i=t.node.getComponent(S);if(i){var n=t.styleIndex,o=null;this._textArray[n]&&(o=this._textArray[n].style),o&&o.color?i.color=this._convertLiteralColorValue(o.color):i.color=x.WHITE,i.setFont(this.font,this.textures),i.lineHeight=this.lineHeight,i.colorGradient=Boolean(o&&o.colorGradient),i.colorGradient&&(i.colorLB=this._convertLiteralColorValue(o.colorGradient.lb),i.colorRB=this._convertLiteralColorValue(o.colorGradient.rb),i.colorLT=this._convertLiteralColorValue(o.colorGradient.lt),i.colorRT=this._convertLiteralColorValue(o.colorGradient.rt)),o&&o.face?(i.tmpUniform.faceColor=this._convertLiteralColorValue(o.face.color),i.tmpUniform.faceDilate=o.face.dilate,i.tmpUniform.faceSoftness=o.face.softness):(i.tmpUniform.faceColor=x.WHITE,i.tmpUniform.faceDilate=.5,i.tmpUniform.faceSoftness=.01),i.enableItalic=Boolean(o&&o.italic),i.enableUnderline=Boolean(o&&o.underline),i.enableUnderline&&(i.underlineOffset=o.offset||0),i.enableStrikethrough=Boolean(o&&o.strikethrough),i.enableStrikethrough&&(i.strikethroughOffset=o.offset||0),i.tmpUniform.enableOutline=Boolean(o&&o.outline),o&&o.outline&&(i.tmpUniform.outlineColor=this._convertLiteralColorValue(o.outline.color),i.tmpUniform.outlineThickness=o.outline.thickness),i.tmpUniform.enableUnderlay=Boolean(o&&o.underlay),i.tmpUniform.enableUnderlay&&(i.tmpUniform.underlayColor=this._convertLiteralColorValue(o.underlay.color),i.tmpUniform.underlayOffset=A(o.underlay.x,o.underlay.y),i.tmpUniform.underlayDilate=o.underlay.dilate,i.tmpUniform.underlaySoftness=o.underlay.softness),i.tmpUniform.enableGlow=Boolean(o&&o.glow),i.tmpUniform.enableGlow&&(i.tmpUniform.glowColor=this._convertLiteralColorValue(o.glow.color),i.tmpUniform.glowOffset=o.glow.offset,i.tmpUniform.glowInner=o.glow.inner,i.tmpUniform.glowOuter=o.glow.outer,i.tmpUniform.glowPower=o.glow.power),o&&o.size?i.fontSize=o.size:i.fontSize=this.fontSize,i.forceUpdateRenderData(),t.clickHandler="",t.clickParam="";var r=null==(e=o)?void 0:e.event;r&&(t.clickHandler=r.click||"",t.clickParam=r.param||"")}},s._applyLayer=function(){for(var t,e=r(this._segments);!(t=e()).done;){t.value.node.layer=this.node.layer}},a(e,[{key:"string",get:function(){return this._string},set:function(t){this._string!==t&&(this._string=t,this._updateRichText())}},{key:"font",get:function(){return this._font},set:function(t){this._font!==t&&(this._font=t,this._layoutDirty=!0,this._updateRichText())}},{key:"horizontalAlign",get:function(){return this._horizontalAlign},set:function(t){this._horizontalAlign!==t&&(this._horizontalAlign=t,this._layoutDirty=!0,this._updateRichText())}},{key:"verticalAlign",get:function(){return this._verticalAlign},set:function(t){this._verticalAlign!==t&&(this._verticalAlign=t,this._layoutDirty=!0,this._updateRichText())}},{key:"fontSize",get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this._layoutDirty=!0,this._updateRichText())}},{key:"maxWidth",get:function(){return this._maxWidth},set:function(t){this._maxWidth!==t&&(this._maxWidth=t,this._layoutDirty=!0,this._updateRichText())}},{key:"lineHeight",get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this._layoutDirty=!0,this._updateRichText())}},{key:"imageAtlas",get:function(){return this._imageAtlas},set:function(t){this._imageAtlas!==t&&(this._imageAtlas=t,this._layoutDirty=!0,this._updateRichText())}},{key:"handleTouchEvent",get:function(){return this._handleTouchEvent},set:function(t){this._handleTouchEvent!==t&&(this._handleTouchEvent=t,this.enabledInHierarchy&&(this.handleTouchEvent?this._addEventListeners():this._removeEventListeners()))}},{key:"labelContent",get:function(){if(!this._labelContent){var t,e="TMP_LABEL_CONTENT";this._labelContent=null!=(t=this.node.getChildByName(e))?t:new y(e),this._labelContent.hideFlags|=L.Flags.DontSave|L.Flags.HideInHierarchy,this.node.insertChild(this._labelContent,this._imageContent?1:0)}return this._labelContent}},{key:"imageContent",get:function(){if(!this._imageContent){var t,e="TMP_IMAGE_CONTENT";this._imageContent=null!=(t=this.node.getChildByName(e))?t:new y(e),this._imageContent.hideFlags|=L.Flags.DontSave|L.Flags.HideInHierarchy,this.node.insertChild(this._imageContent,0)}return this._imageContent}}]),e}(b)).prototype,"_string",[nt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),e(M.prototype,"string",[I],Object.getOwnPropertyDescriptor(M.prototype,"string"),M.prototype),V=e(M.prototype,"_font",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),e(M.prototype,"font",[E],Object.getOwnPropertyDescriptor(M.prototype,"font"),M.prototype),Y=e(M.prototype,"_horizontalAlign",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return f.LEFT}}),e(M.prototype,"horizontalAlign",[W],Object.getOwnPropertyDescriptor(M.prototype,"horizontalAlign"),M.prototype),J=e(M.prototype,"_verticalAlign",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return p.TOP}}),e(M.prototype,"verticalAlign",[k],Object.getOwnPropertyDescriptor(M.prototype,"verticalAlign"),M.prototype),K=e(M.prototype,"_fontSize",[nt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 32}}),e(M.prototype,"fontSize",[U],Object.getOwnPropertyDescriptor(M.prototype,"fontSize"),M.prototype),q=e(M.prototype,"_maxWidth",[nt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),e(M.prototype,"maxWidth",[R],Object.getOwnPropertyDescriptor(M.prototype,"maxWidth"),M.prototype),Q=e(M.prototype,"_lineHeight",[nt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 32}}),e(M.prototype,"lineHeight",[nt],Object.getOwnPropertyDescriptor(M.prototype,"lineHeight"),M.prototype),Z=e(M.prototype,"_imageAtlas",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),e(M.prototype,"imageAtlas",[N],Object.getOwnPropertyDescriptor(M.prototype,"imageAtlas"),M.prototype),$=e(M.prototype,"_handleTouchEvent",[nt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),e(M.prototype,"handleTouchEvent",[nt],Object.getOwnPropertyDescriptor(M.prototype,"handleTouchEvent"),M.prototype),tt=e(M.prototype,"material",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),et=e(M.prototype,"textures",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),G=M))||G)||G)||G));s._RF.pop()}}}));

System.register("chunks:///_virtual/TmpUtils.ts",["cc"],(function(t){var u;return{setters:[function(t){u=t.cclegacy}],execute:function(){u._RF.push({},"a0698HuGsRM85nr22PDZ+bP","TmpUtils",void 0);var e=/([a-zA-Z0-9ÄÖÜäöüßéèçàùêâîôûа-яА-ЯЁё]+|\S)/,n=/^[!,.:;'}\]%\?>、‘“》？。，！]/,r=/([a-zA-Z0-9ÄÖÜäöüßéèçàùêâîôûаíìÍÌïÁÀáàÉÈÒÓòóŐőÙÚŰúűñÑæÆœŒÃÂãÔõěščřžýáíéóúůťďňĚŠČŘŽÁÍÉÓÚŤżźśóńłęćąŻŹŚÓŃŁĘĆĄ-яА-ЯЁёáàảạãăắằẳẵặâấầẩẫậéèẻẽẹêếềểễệiíìỉĩịóòỏõọôốồổỗộơớờởỡợúùủũụưứừửữựýỳỷỹỵđÁÀẢẠÃĂẮẰẲẴẶÂẤẦẨẪẬÉÈẺẼẸÊẾỀỂỄỆIÍÌỈĨỊÓÒỎÕỌÔỐỒỔỖỘƠỚỜỞỠỢÚÙỦŨỤƯỨỪỬỮỰÝỲỶỸỴĐ]+|\S)$/,i=/[a-zA-Z0-9ÄÖÜäöüßéèçàùêâîôûаíìÍÌïÁÀáàÉÈÒÓòóŐőÙÚŰúűñÑæÆœŒÃÂãÔõěščřžýáíéóúůťďňĚŠČŘŽÁÍÉÓÚŤżźśóńłęćąŻŹŚÓŃŁĘĆĄ-яА-ЯЁёáàảạãăắằẳẵặâấầẩẫậéèẻẽẹêếềểễệiíìỉĩịóòỏõọôốồổỗộơớờởỡợúùủũụưứừửữựýỳỷỹỵđÁÀẢẠÃĂẮẰẲẴẶÂẤẦẨẪẬÉÈẺẼẸÊẾỀỂỄỆIÍÌỈĨỊÓÒỎÕỌÔỐỒỔỖỘƠỚỜỞỠỢÚÙỦŨỤƯỨỪỬỮỰÝỲỶỸỴĐ]+$/,c=/^[a-zA-Z0-9ÄÖÜäöüßéèçàùêâîôûаíìÍÌïÁÀáàÉÈÒÓòóŐőÙÚŰúűñÑæÆœŒÃÂãÔõěščřžýáíéóúůťďňĚŠČŘŽÁÍÉÓÚŤżźśóńłęćąŻŹŚÓŃŁĘĆĄ-яА-ЯЁёáàảạãăắằẳẵặâấầẩẫậéèẻẽẹêếềểễệiíìỉĩịóòỏõọôốồổỗộơớờởỡợúùủũụưứừửữựýỳỷỹỵđÁÀẢẠÃĂẮẰẲẴẶÂẤẦẨẪẬÉÈẺẼẸÊẾỀỂỄỆIÍÌỈĨỊÓÒỎÕỌÔỐỒỔỖỘƠỚỜỞỠỢÚÙỦŨỤƯỨỪỬỮỰÝỲỶỸỴĐ]/;function s(t,u,e){var n=u,r=e,i=t[u];if(i>="\udc00"&&i<="\udfff"&&n--,void 0!==e)if(e-1!==u){var c=t[e-1];c>="\ud800"&&c<="\udbff"&&r--}else i>="\ud800"&&i<="\udbff"&&r++;return t.substring(n,r)}t("default",function(){function t(){}return t.load=function(t){return new Promise((function(t,u){t(null)}))},t.waitCmpt=function(t,u){return new Promise((function(e,n){t.scheduleOnce((function(){e()}),u)}))},t.isUnicodeCJK=function(t){return/^[\u4E00-\u9FFF\u3400-\u4DFF]+$/.test(t)||/[\u3000-\u303F]|[\u3040-\u309F]|[\u30A0-\u30FF]|[\uFF00-\uFFEF]|[\u4E00-\u9FAF]|[\u2605-\u2606]|[\u2190-\u2195]|\u203B/g.test(t)||/^[\u1100-\u11FF]|[\u3130-\u318F]|[\uA960-\uA97F]|[\uAC00-\uD7AF]|[\uD7B0-\uD7FF]+$/.test(t)},t.isUnicodeSpace=function(t){var u=t.charCodeAt(0);return u>=9&&u<=13||32===u||133===u||160===u||5760===u||u>=8192&&u<=8202||8232===u||8233===u||8239===u||8287===u||12288===u},t.getEnglishWordPartAtFirst=function(t){return c.exec(t)},t.getEnglishWordPartAtLast=function(t){return i.exec(t)},t.fragmentText=function(t,u,o,f){var a=[];if(0===t.length||o<0)return a.push(""),a;for(var F=t;u>o&&F.length>1;){for(var l=F.length*(o/u)|0,h=s(F,l),d=u-f(h),g=h,v=0,A=0;d>o&&A++<100;)l*=o/d,d=u-f(h=s(F,l|=0));for(A=0;h&&d<=o&&A++<100;){var m=e.exec(h);g=h,d=u-f(h=s(F,l+=v=m?m[0].length:1))}0===(l-=v)?(l=1,g=s(F,1)):1===l&&F[0]>="\ud800"&&F[0]<="\udbff"&&(l=2,g=s(F,2));var p=s(F,0,l),x=void 0;n.test(g||h)&&(0===(l-=(x=r.exec(p))?x[0].length:0)&&(l=1),g=s(F,l),p=s(F,0,l)),c.test(g)&&(x=i.exec(p))&&p!==x[0]&&(g=s(F,l-=x[0].length),p=s(F,0,l)),(0===a.length||(p=p.trim()).length>0)&&a.push(p),u=f(F=g||h)}return(0===a.length||(F=F.trim()).length>0)&&a.push(F),a},t}()).TMP_MAT="textMeshPro/resources/shader/materials/textMeshPro.mtl",u._RF.pop()}}}));

System.register("chunks:///_virtual/TurnController.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index.mjs_cjs=&original=.js","./helper.ts","./resources.ts","./system.ts","./index.ts","./index2.ts","./index.js","./common.ts","./sender.ts"],(function(e){var n,t,r,o,s,i,u,a,l,h,c,d,f,p;return{setters:[function(e){n=e.inheritsLoose},function(e){t=e.cclegacy,r=e._decorator,o=e.Node,s=e.Button,i=e.Color,u=e.Component},null,function(e){a=e.setCursor},function(e){l=e.playEffectSound},function(e){h=e.system},null,null,function(e){c=e.default},function(e){d=e.animateFade,f=e.animateSwapLabel},function(e){p=e.sendEndTurn}],execute:function(){var b;t._RF.push({},"21ee291zRZEKbq4wP1p9CeZ","TurnController",void 0);var y=c.DuelPhases,m=r.ccclass,v=o.EventType,C=s.EventType;e("TurnController",m("TurnController")(b=function(e){function t(){for(var n,t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return(n=e.call.apply(e,[this].concat(r))||this).unSubscribers=[],n.playerTurnGlow=void 0,n.enemyTurnGlow=void 0,n.turnLabel=void 0,n.orb=void 0,n}n(t,e);var r=t.prototype;return r.start=function(){var e=this;this.playerTurnGlow=this.node.getChildByPath("Orb/Player Glow"),this.enemyTurnGlow=this.node.getChildByPath("Orb/Enemy Glow"),this.turnLabel=this.node.getChildByPath("Orb/Button/Label"),this.orb=this.node.getChildByPath("Orb"),this.orb.on(v.MOUSE_ENTER,this.onMouseEnter.bind(this)),this.orb.on(v.MOUSE_LEAVE,this.onMouseLeave.bind(this)),this.orb.on(C.CLICK,this.onButtonClick.bind(this)),this.unSubscribers.push(h.duel.subscribe("phase",(function(n){return e.onPhaseChange(n,h.duel.phaseOf)}))),this.unSubscribers.push(h.duel.subscribe("phaseOf",(function(n){return e.onPhaseChange(h.duel.phase,n)})))},r.onDestroy=function(){this.unSubscribers.forEach((function(e){return e()}))},r.onPhaseChange=function(e,n){var t=e===y.Setup,r=n===h.playerIds.me,o=this.orb.getComponent(s),u=i.fromHEX(new i,r?"#4da7ea":"#ee5846"),a=i.fromHEX(new i,"#ffffff");if(t?(o.interactable=!0,d(this.playerTurnGlow,r?255:0),d(this.enemyTurnGlow,r?0:255)):(o.interactable=!1,d(this.playerTurnGlow,0),d(this.enemyTurnGlow,0)),e===y.Draw){var l=0===h.duel.turn?"distribute":"draw";f(this.turnLabel,l,u)}else if(e===y.Setup){var c=r?"end turn":"enemy turn";f(this.turnLabel,c,u)}else e===y.PreFight?f(this.turnLabel,"pre fight",a):e===y.Fight?f(this.turnLabel,"fight",a):e===y.PostFight&&f(this.turnLabel,"post fight",a)},r.onMouseEnter=function(){var e=h.duel.phase===y.Setup,n=h.duel.phaseOf===h.playerIds.me;e&&n&&a("pointer")},r.onMouseLeave=function(){a("auto")},r.onButtonClick=function(){var e=h.duel.phase===y.Setup,n=h.duel.phaseOf===h.playerIds.me;!h.winner&&e&&n&&(l("end-turn"),p())},t}(u))||b);t._RF.pop()}}}));

System.register("chunks:///_virtual/types.ts",["cc"],(function(e){var n;return{setters:[function(e){n=e.cclegacy}],execute:function(){n._RF.push({},"b9849Q5wzxDcrqWw9j/6mLS","types",void 0);e("GameEventType",function(e){return e.ConnectMatch="ConnectMatch",e.SendBundle="SendBundle",e.CardHover="CardHover",e.GameOver="GameOver",e}({}));n._RF.pop()}}}));

System.register("chunks:///_virtual/UnitManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index.mjs_cjs=&original=.js","./attribute.ts","./helper.ts","./resources.ts","./system.ts","./CardManager.ts","./index2.ts","./index.js","./preview.ts"],(function(t){var e,i,a,n,r,o,d,s,c,l,h,u,g,f,v,p,C;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,a=t._decorator,n=t.Node,r=t.UIOpacity,o=t.Sprite,d=t.resources,s=t.Component},null,function(t){c=t.updateUnit},function(t){l=t.getVisualUri,h=t.getFoilUri,u=t.setCursor},function(t){g=t.playEffectSound},function(t){f=t.system},function(t){v=t.CardManager},null,function(t){p=t.default},function(t){C=t.raiseUnitPreview}],execute:function(){var y;i._RF.push({},"679f760eihMgrm4ElJYfqwd","UnitManager",void 0);var M=a.ccclass,P=n.EventType,b=p.ActivationType,m=p.getCard,E=p.getCardState;t("UnitManager",M("UnitManager")(y=function(t){function i(){for(var e,i=arguments.length,a=new Array(i),n=0;n<i;n++)a[n]=arguments[n];return(e=t.call.apply(t,[this].concat(a))||this).unsubscribe=void 0,e.cardId=void 0,e.uiOpacity=void 0,e.cardFoil=void 0,e.cardVisual=void 0,e.cardAttack=void 0,e.cardDefense=void 0,e.cardHealth=void 0,e}e(i,t);var a=i.prototype;return a.start=function(){this.uiOpacity=this.node.getComponent(r),this.cardFoil=this.node.getChildByPath("front/foil").getComponent(o),this.cardVisual=this.node.getChildByPath("front/visual").getComponent(o),this.cardAttack=this.node.getChildByPath("front/attack"),this.cardDefense=this.node.getChildByPath("front/defense"),this.cardHealth=this.node.getChildByPath("front/health"),this.cardId&&this.renderCard(E(f.duel.stateMap,this.cardId)),this.node.on(P.MOUSE_ENTER,this.onMouseEnter.bind(this)),this.node.on(P.MOUSE_LEAVE,this.onMouseLeave.bind(this))},a.setCardId=function(t){t!==this.cardId&&(this.cardId=t)},a.renderCard=function(t){var e,i=this;if(this.cardFoil){var a=m(f.duel.cardMap,t.id),n=l(a.id),r=h(a.id,"-ground");d.load(n,(function(t,e){t||(i.cardVisual.spriteFrame=e)})),d.load(r,(function(t,e){t||(i.cardFoil.spriteFrame=e)})),(null==(e=a.skill)?void 0:e.activation)===b.Charge&&(this.node.getChildByPath("front/charge").active=!0),c(t.id)}},a.onMouseEnter=function(){var t;if(u("pointer"),!f.winner&&!f.dragging&&this.cardId&&(null==(t=this.node.getChildByPath("back"))||!t.active)){var e=f.globalNodes.cardPreview.getChildByPath("Card");f.globalNodes.cardPreview.getChildByPath("Card/glow").active=!1,g("card-raise",.2),C(f.globalNodes.cardPreview,this.node),e.getComponent(v).setCardId(this.cardId.substring(0,9))}},a.onMouseLeave=function(){u("auto"),f.globalNodes.cardPreview.setPosition(190,740)},i}(s))||y);i._RF.pop()}}}));

System.register("chunks:///_virtual/util.ts",["cc","./system.ts"],(function(t){var e,o;return{setters:[function(t){e=t.cclegacy},function(t){o=t.system}],execute:function(){var c;e._RF.push({},"19fb5JQSsNBy4XoMBj4Ih13","util",void 0);var s=(null==(c=localStorage)?void 0:c.getItem("GAME_WS_URI"))||"ws://localhost:3005/ws";console.log("Game Websocket URI",s);t("ws",new WebSocket(s)),t("mergeRemoteHistory",(function(t,e){return o.history.length<e?{conflict:!0}:(o.history=o.history.slice(0,e).concat(t),{conflict:!1})}));e._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});